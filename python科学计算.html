<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-09-27 Sun 17:24 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Python科学计算</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="chimez" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Python科学计算</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org3576466">1. numpy</a>
<ul>
<li><a href="#org96f1542">1.1. 启用 MKL 支持</a>
<ul>
<li><a href="#org873bd84">1.1.1. 编译安装OpenBLAS</a></li>
<li><a href="#orga530571">1.1.2. 编译安装numpy</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2ef36fe">2. scipy</a>
<ul>
<li><a href="#org6e71128">2.1. Scipy 的库</a></li>
<li><a href="#org01bc2e1">2.2. scipy.sparse 稀疏矩阵</a>
<ul>
<li><a href="#orga4d7647">2.2.1. 稀疏矩阵格式</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org70990f7">3. pandas</a>
<ul>
<li><a href="#org6efd920">3.1. 数据表格和矩阵之间的转换</a>
<ul>
<li><a href="#org7741dc2">3.1.1. 从点的坐标表格 <code>(x,y,z)</code> 得到矩阵</a></li>
<li><a href="#org1ce6f6b">3.1.2. 从矩阵表格得到坐标表格</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org565ab03">4. matplotlib</a>
<ul>
<li><a href="#org30b8cda">4.1. 画 3D 曲面图</a></li>
<li><a href="#org3434daf">4.2. 画 3D 箭头场图</a></li>
<li><a href="#orgc860c8b">4.3. matplotlib使用中文与latex</a>
<ul>
<li><a href="#orgf0db9cb">4.3.1. 图片中的文本使用latex符号</a></li>
<li><a href="#orgdf727e5">4.3.2. 中文显示</a></li>
<li><a href="#orgdfa4811">4.3.3. 图注和标签中的数学字体</a></li>
</ul>
</li>
<li><a href="#org54f665b">4.4. Legend中指定线和图例相对应的方法</a></li>
<li><a href="#org2d08fb4">4.5. 并行化画图时,解决爆内存和同一图中画了好多线的方法</a></li>
<li><a href="#orga4d2d9d">4.6. 让画出来的图片连在一起动起来的方法</a></li>
<li><a href="#orgc6bad17">4.7. 保存图片时超出的部分存不上</a></li>
<li><a href="#orgc72800a">4.8. 保存图片时没有 <code>suptitle</code> 部分</a></li>
<li><a href="#orge3bdadf">4.9. 设置默认绘图样式</a>
<ul>
<li><a href="#orge1353f5">4.9.1. 设置全局样式</a></li>
<li><a href="#org5da83d8">4.9.2. 设置和使用局部样式</a></li>
</ul>
</li>
<li><a href="#org2974341">4.10. 在 JupyterLab 里让图动起来</a></li>
</ul>
</li>
<li><a href="#orge98542d">5. seaborn</a>
<ul>
<li><a href="#org577843c">5.1. 设置样式</a></li>
<li><a href="#orge603db8">5.2. lineplot</a></li>
<li><a href="#org7d7f94c">5.3. heatmap</a></li>
</ul>
</li>
<li><a href="#org559cc1b">6. bokeh</a>
<ul>
<li><a href="#org919eb83">6.1. 基本示例</a></li>
</ul>
</li>
<li><a href="#orgc6655aa">7. jupyter</a>
<ul>
<li><a href="#orge492349">7.1. 常用模板</a></li>
<li><a href="#orgc9895de">7.2. 有用的插件</a></li>
<li><a href="#orgfe68c84">7.3. 在jupyter中使用ipdb</a></li>
<li><a href="#orgec8ea65">7.4. 运行时间分析</a></li>
<li><a href="#orgdea690b">7.5. 使用 JavaScript</a>
<ul>
<li><a href="#org6ab4bc2">7.5.1. 创建 DOM</a></li>
<li><a href="#org0cc67ec">7.5.2. 执行 js 语句</a></li>
</ul>
</li>
<li><a href="#org03f8580">7.6. 动态组件 ipywidgets</a>
<ul>
<li><a href="#org9fe71f7">7.6.1. 安装</a></li>
<li><a href="#org9ff2a58">7.6.2. 基本动态组件 - 使用 interact</a></li>
</ul>
</li>
<li><a href="#org055998b">7.7. 自动重加载库</a></li>
<li><a href="#org3838c8c">7.8. nbdime：diff 工具</a>
<ul>
<li><a href="#orgf66f69c">7.8.1. 安装</a></li>
<li><a href="#org379adf8">7.8.2. 基本使用</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org34e7237">8. cython</a>
<ul>
<li><a href="#orgef01551">8.1. 编译</a></li>
<li><a href="#org41fc406">8.2. 与 numpy 的结合</a>
<ul>
<li><a href="#orga60bb11">8.2.1. 配置</a></li>
<li><a href="#orge0be5aa">8.2.2. 类型</a></li>
<li><a href="#org98eda42">8.2.3. 获得指针</a></li>
</ul>
</li>
<li><a href="#orgb67ae94">8.3. 向外部 c 函数传递数组</a>
<ul>
<li><a href="#org04485db">8.3.1. h 文件中的声明</a></li>
<li><a href="#orgb9dc29f">8.3.2. pxd 文件中的声明</a></li>
<li><a href="#org24d945d">8.3.3. pyx 中的用法</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org80dab03">9. pillow: 图像处理</a></li>
<li><a href="#org7ac60fd">10. opencv: 图像处理</a>
<ul>
<li><a href="#orgeb037e3">10.1. 对图片进行切边操作</a></li>
</ul>
</li>
<li><a href="#org6b0807c">11. ctypes: c 互操作标准库</a></li>
<li><a href="#org5a767c3">12. cffi: c/c++ 互操作</a>
<ul>
<li><a href="#org3843369">12.1. 基本使用</a>
<ul>
<li><a href="#org27eb6a7">12.1.1. 内联调用方式</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org30946f0">13. pytesseract: OCR 识别库</a></li>
</ul>
</div>
</div>




<div id="outline-container-org3576466" class="outline-2">
<h2 id="org3576466"><span class="section-number-2">1</span> numpy</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org96f1542" class="outline-3">
<h3 id="org96f1542"><span class="section-number-3">1.1</span> 启用 MKL 支持</h3>
<div class="outline-text-3" id="text-1-1">
<p>
修改配置文件 <code>site.cfg</code>
</p>

<p>
然后
</p>
<div class="org-src-container">
<pre class="src src-bash">python setup.py build -j 4 install --prefix $<span style="color: #268bd2;">HOME</span>/.local
</pre>
</div>
</div>

<div id="outline-container-org873bd84" class="outline-4">
<h4 id="org873bd84"><span class="section-number-4">1.1.1</span> 编译安装OpenBLAS</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
<a href="https://github.com/xianyi/OpenBLAS">https://github.com/xianyi/OpenBLAS</a>
</p>
<div class="org-src-container">
<pre class="src src-bash">make <span style="color: #268bd2;">FC</span>=gfortran
make <span style="color: #268bd2;">PREFIX</span>=/opt/OpenBLAS install
</pre>
</div>
<p>
添加环境路径
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #657b83; font-weight: bold;">export</span> <span style="color: #268bd2;">LD_LIBRARY_PATH</span>=/opt/OpenBLAS/lib:$<span style="color: #268bd2;">LD_LIBRARY_PATH</span>
<span style="color: #657b83; font-weight: bold;">export</span> <span style="color: #268bd2;">C_INCLUDE_PATH</span>=/opt/OpenBLAS/include:$<span style="color: #268bd2;">C_INCLUDE_PATH</span> 
<span style="color: #657b83; font-weight: bold;">export</span> <span style="color: #268bd2;">CPLUS_INCLUDE_PATH</span>=/opt/OpenBLAS/include:$<span style="color: #268bd2;">CPLUS_INCLUDE_PATH</span> 
</pre>
</div>
</div>
</div>

<div id="outline-container-orga530571" class="outline-4">
<h4 id="orga530571"><span class="section-number-4">1.1.2</span> 编译安装numpy</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
修改设置文件
</p>
<div class="org-src-container">
<pre class="src src-bash">cp site.cfg.example site.cfg

<span style="color: #2aa198;">[</span>openblas<span style="color: #2aa198;">]</span>
<span style="color: #268bd2;">libraries</span> = openblas
<span style="color: #268bd2;">library_dirs</span> = /opt/OpenBLAS/lib
<span style="color: #268bd2;">include_dirs</span> = /opt/OpenBLAS/include
...
</pre>
</div>
<p>
编译安装
</p>
<div class="org-src-container">
<pre class="src src-bash">python3 setup.py install --user
</pre>
</div>
</div>
</div>
</div>
</div>


<div id="outline-container-org2ef36fe" class="outline-2">
<h2 id="org2ef36fe"><span class="section-number-2">2</span> scipy</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org6e71128" class="outline-3">
<h3 id="org6e71128"><span class="section-number-3">2.1</span> Scipy 的库</h3>
<div class="outline-text-3" id="text-2-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>Subpackage</code></td>
<td class="org-left">Description</td>
</tr>

<tr>
<td class="org-left"><code>cluster</code></td>
<td class="org-left">聚类算法Clustering algorithms</td>
</tr>

<tr>
<td class="org-left"><code>constants</code></td>
<td class="org-left">物理和数学常数Physical and mathematical constants</td>
</tr>

<tr>
<td class="org-left"><code>fftpack</code></td>
<td class="org-left">快速傅立叶变换Fast Fourier Transform routines</td>
</tr>

<tr>
<td class="org-left"><code>integrate</code></td>
<td class="org-left">积分和常微分方程解Integration and ordinary differential equation solvers</td>
</tr>

<tr>
<td class="org-left"><code>interpolate</code></td>
<td class="org-left">插值和光滑样条Interpolation and smoothing splines</td>
</tr>

<tr>
<td class="org-left"><code>io</code></td>
<td class="org-left">输入输出Input and Output</td>
</tr>

<tr>
<td class="org-left"><code>linalg</code></td>
<td class="org-left">线性代数Linear algebra</td>
</tr>

<tr>
<td class="org-left"><code>ndimage</code></td>
<td class="org-left">n维图像处理N-dimensional image processing</td>
</tr>

<tr>
<td class="org-left"><code>odr</code></td>
<td class="org-left">正交距离回归Orthogonal distance regression</td>
</tr>

<tr>
<td class="org-left"><code>optimize</code></td>
<td class="org-left">优化和寻根Optimization and root-finding routines</td>
</tr>

<tr>
<td class="org-left"><code>signal</code></td>
<td class="org-left">信号处理Signal processing</td>
</tr>

<tr>
<td class="org-left"><code>sparse</code></td>
<td class="org-left">稀疏矩阵和相关Sparse matrices and associated routines</td>
</tr>

<tr>
<td class="org-left"><code>spatial</code></td>
<td class="org-left">空间数据结构和算法Spatial data structures and algorithms</td>
</tr>

<tr>
<td class="org-left"><code>special</code></td>
<td class="org-left">特殊函数Special functions</td>
</tr>

<tr>
<td class="org-left"><code>stats</code></td>
<td class="org-left">统计分布和函数Statistical distributions and functions</td>
</tr>

<tr>
<td class="org-left"><code>weave</code></td>
<td class="org-left">c/c++集成C/C++ integration</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org01bc2e1" class="outline-3">
<h3 id="org01bc2e1"><span class="section-number-3">2.2</span> scipy.sparse 稀疏矩阵</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-orga4d7647" class="outline-4">
<h4 id="orga4d7647"><span class="section-number-4">2.2.1</span> 稀疏矩阵格式</h4>
<div class="outline-text-4" id="text-2-2-1">
<ul class="org-ul">
<li>coo格式用于构造和存储矩阵，矩阵构造或读取之后转换为 csr 或 csc 格式进行操作。</li>
<li>csr、csc格式用作矩阵运算</li>
<li>lil格式可以按列添加</li>
<li>dia格式用来储存对角元多的矩阵</li>
</ul>
</div>
</div>
</div>
</div>


<div id="outline-container-org70990f7" class="outline-2">
<h2 id="org70990f7"><span class="section-number-2">3</span> pandas</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org6efd920" class="outline-3">
<h3 id="org6efd920"><span class="section-number-3">3.1</span> 数据表格和矩阵之间的转换</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org7741dc2" class="outline-4">
<h4 id="org7741dc2"><span class="section-number-4">3.1.1</span> 从点的坐标表格 <code>(x,y,z)</code> 得到矩阵</h4>
<div class="outline-text-4" id="text-3-1-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #268bd2;">data</span> = pd.DataFrame<span style="color: #2aa198;">(</span><span style="color: #b58900;">{</span><span style="color: #2aa198;">"x"</span>: <span style="color: #268bd2;">[</span>1,1,2,2<span style="color: #268bd2;">]</span>, <span style="color: #2aa198;">"y"</span>:<span style="color: #268bd2;">[</span>3,4,3,4<span style="color: #268bd2;">]</span>,<span style="color: #2aa198;">"z"</span>:<span style="color: #268bd2;">[</span>9,8,7,6<span style="color: #268bd2;">]</span><span style="color: #b58900;">}</span><span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">data_2x2</span> = data.pivot<span style="color: #2aa198;">(</span>index=<span style="color: #2aa198;">"x"</span>,columns=<span style="color: #2aa198;">"y"</span>, values=<span style="color: #2aa198;">"z"</span><span style="color: #2aa198;">)</span>

<span style="color: #268bd2;">matrix</span> = data_2x2.to_numpy<span style="color: #2aa198;">()</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1ce6f6b" class="outline-4">
<h4 id="org1ce6f6b"><span class="section-number-4">3.1.2</span> 从矩阵表格得到坐标表格</h4>
<div class="outline-text-4" id="text-3-1-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #268bd2;">data</span> = pd.DataFrame<span style="color: #2aa198;">(</span><span style="color: #b58900;">{</span><span style="color: #2aa198;">"x"</span>: <span style="color: #268bd2;">[</span>1,1,2,2<span style="color: #268bd2;">]</span>, <span style="color: #2aa198;">"y"</span>:<span style="color: #268bd2;">[</span>3,4,3,4<span style="color: #268bd2;">]</span>,<span style="color: #2aa198;">"z"</span>:<span style="color: #268bd2;">[</span>9,8,7,6<span style="color: #268bd2;">]</span><span style="color: #b58900;">}</span><span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">data_2x2</span> = data.pivot<span style="color: #2aa198;">(</span>index=<span style="color: #2aa198;">"x"</span>,columns=<span style="color: #2aa198;">"y"</span>, values=<span style="color: #2aa198;">"z"</span><span style="color: #2aa198;">)</span>

<span style="color: #268bd2;">d</span> = data_2x2.unstack<span style="color: #2aa198;">()</span>.reset_index<span style="color: #2aa198;">()</span>
<span style="color: #268bd2;">d.columns</span> = <span style="color: #2aa198;">[</span><span style="color: #2aa198;">'y'</span>,<span style="color: #2aa198;">'x'</span>,<span style="color: #2aa198;">'z'</span><span style="color: #2aa198;">]</span>
</pre>
</div>
</div>
</div>
</div>
</div>


<div id="outline-container-org565ab03" class="outline-2">
<h2 id="org565ab03"><span class="section-number-2">4</span> matplotlib</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org30b8cda" class="outline-3">
<h3 id="org30b8cda"><span class="section-number-3">4.1</span> 画 3D 曲面图</h3>
<div class="outline-text-3" id="text-4-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #859900; font-weight: bold;">as</span> plt
<span style="color: #859900; font-weight: bold;">from</span> matplotlib <span style="color: #859900; font-weight: bold;">import</span> cm
<span style="color: #268bd2;">xl</span> = np.linspace<span style="color: #2aa198;">(</span>0,1,10<span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">yl</span> = np.linspace<span style="color: #2aa198;">(</span>0,1,10<span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">X</span>, <span style="color: #268bd2;">Y</span> = np.meshgrid<span style="color: #2aa198;">(</span>xl, yl<span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">Z</span> = np.cos<span style="color: #2aa198;">(</span>X<span style="color: #2aa198;">)</span> + np.sin<span style="color: #2aa198;">(</span>Y<span style="color: #2aa198;">)</span>

<span style="color: #268bd2;">fig</span> = plt.figure<span style="color: #2aa198;">()</span>
<span style="color: #268bd2;">ax</span> = fig.gca<span style="color: #2aa198;">(</span>projection=<span style="color: #2aa198;">'3d'</span><span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">surf</span> = ax.plot_surface<span style="color: #2aa198;">(</span>X, Y, Z, cmap=cm.coolwarm,
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>  linewidth=0, antialiased=<span style="color: #268bd2; font-weight: bold;">False</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3434daf" class="outline-3">
<h3 id="org3434daf"><span class="section-number-3">4.2</span> 画 3D 箭头场图</h3>
<div class="outline-text-3" id="text-4-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">from</span> mpl_toolkits.mplot3d <span style="color: #859900; font-weight: bold;">import</span> axes3d
<span style="color: #859900; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #859900; font-weight: bold;">as</span> plt
<span style="color: #859900; font-weight: bold;">import</span> numpy <span style="color: #859900; font-weight: bold;">as</span> np

<span style="color: #268bd2;">fig</span> = plt.figure<span style="color: #2aa198;">()</span>
<span style="color: #268bd2;">ax</span> = fig.gca<span style="color: #2aa198;">(</span>projection=<span style="color: #2aa198;">'3d'</span><span style="color: #2aa198;">)</span>

<span style="color: #268bd2;">x</span>, <span style="color: #268bd2;">y</span>, <span style="color: #268bd2;">z</span> = np.meshgrid<span style="color: #2aa198;">(</span>np.arange<span style="color: #b58900;">(</span>-0.8, 1, 0.2<span style="color: #b58900;">)</span>,
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span> np.arange<span style="color: #b58900;">(</span>-0.8, 1, 0.2<span style="color: #b58900;">)</span>,
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span> np.arange<span style="color: #b58900;">(</span>-0.8, 1, 0.8<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

<span style="color: #268bd2;">u</span> = np.sin<span style="color: #2aa198;">(</span>np.pi * x<span style="color: #2aa198;">)</span> * np.cos<span style="color: #2aa198;">(</span>np.pi * y<span style="color: #2aa198;">)</span> * np.cos<span style="color: #2aa198;">(</span>np.pi * z<span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">v</span> = -np.cos<span style="color: #2aa198;">(</span>np.pi * x<span style="color: #2aa198;">)</span> * np.sin<span style="color: #2aa198;">(</span>np.pi * y<span style="color: #2aa198;">)</span> * np.cos<span style="color: #2aa198;">(</span>np.pi * z<span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">w</span> = <span style="color: #2aa198;">(</span>np.sqrt<span style="color: #b58900;">(</span>2.0 / 3.0<span style="color: #b58900;">)</span> * np.cos<span style="color: #b58900;">(</span>np.pi * x<span style="color: #b58900;">)</span> * np.cos<span style="color: #b58900;">(</span>np.pi * y<span style="color: #b58900;">)</span> *
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>np.sin<span style="color: #b58900;">(</span>np.pi * z<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>

ax.quiver<span style="color: #2aa198;">(</span>x, y, z, u, v, w, length=0.1<span style="color: #2aa198;">)</span>

plt.show<span style="color: #2aa198;">()</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc860c8b" class="outline-3">
<h3 id="orgc860c8b"><span class="section-number-3">4.3</span> matplotlib使用中文与latex</h3>
<div class="outline-text-3" id="text-4-3">
</div>
<div id="outline-container-orgf0db9cb" class="outline-4">
<h4 id="orgf0db9cb"><span class="section-number-4">4.3.1</span> 图片中的文本使用latex符号</h4>
<div class="outline-text-4" id="text-4-3-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">from</span> matplotlib <span style="color: #859900; font-weight: bold;">import</span> rc
rc<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'text'</span>,usetex=<span style="color: #268bd2; font-weight: bold;">True</span><span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgdf727e5" class="outline-4">
<h4 id="orgdf727e5"><span class="section-number-4">4.3.2</span> 中文显示</h4>
<div class="outline-text-4" id="text-4-3-2">
<p>
关键在于自己指定字体
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #268bd2;">plt.rcParams</span><span style="color: #2aa198;">[</span><span style="color: #2aa198;">'font.sans-serif'</span><span style="color: #2aa198;">]</span>=<span style="color: #2aa198;">[</span><span style="color: #2aa198;">'SimHei'</span><span style="color: #2aa198;">]</span> <span style="color: #93a1a1;">#</span><span style="color: #93a1a1;">&#29992;&#26469;&#27491;&#24120;&#26174;&#31034;&#20013;&#25991;&#26631;&#31614;</span>
<span style="color: #268bd2;">plt.rcParams</span><span style="color: #2aa198;">[</span><span style="color: #2aa198;">'axes.unicode_minus'</span><span style="color: #2aa198;">]</span>=<span style="color: #268bd2; font-weight: bold;">False</span> <span style="color: #93a1a1;">#</span><span style="color: #93a1a1;">&#29992;&#26469;&#27491;&#24120;&#26174;&#31034;&#36127;&#21495;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdfa4811" class="outline-4">
<h4 id="orgdfa4811"><span class="section-number-4">4.3.3</span> 图注和标签中的数学字体</h4>
<div class="outline-text-4" id="text-4-3-3">
<div class="org-src-container">
<pre class="src src-python">plt.rcdefaults<span style="color: #2aa198;">()</span>
<span style="color: #268bd2;">plt.rcParams</span><span style="color: #2aa198;">[</span><span style="color: #2aa198;">'mathtext.it'</span><span style="color: #2aa198;">]</span>=<span style="color: #2aa198;">'sans:italic'</span>
<span style="color: #268bd2;">plt.rcParams</span><span style="color: #2aa198;">[</span><span style="color: #2aa198;">'mathtext.fontset'</span><span style="color: #2aa198;">]</span>=<span style="color: #2aa198;">'custom'</span>
<span style="color: #268bd2;">plt.rcParams</span><span style="color: #2aa198;">[</span><span style="color: #2aa198;">'font.family'</span><span style="color: #2aa198;">]</span>=<span style="color: #2aa198;">'Times New Roman'</span>
<span style="color: #268bd2;">plt.rcParams</span><span style="color: #2aa198;">[</span><span style="color: #2aa198;">'font.style'</span><span style="color: #2aa198;">]</span>=<span style="color: #2aa198;">'normal'</span>
<span style="color: #268bd2;">plt.rcParams</span><span style="color: #2aa198;">[</span><span style="color: #2aa198;">'font.sans-serif'</span><span style="color: #2aa198;">]</span>=<span style="color: #2aa198;">[</span><span style="color: #2aa198;">'DejaVu Serif'</span><span style="color: #2aa198;">]</span>
<span style="color: #268bd2;">plt.rcParams</span><span style="color: #2aa198;">[</span><span style="color: #2aa198;">'font.size'</span><span style="color: #2aa198;">]</span>=14
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org54f665b" class="outline-3">
<h3 id="org54f665b"><span class="section-number-3">4.4</span> Legend中指定线和图例相对应的方法</h3>
<div class="outline-text-3" id="text-4-4">
<p>
在plot时的返回参数是两个,所以加逗号忽略第二个参数,用第一个来加图例才行
</p>
<div class="org-src-container">
<pre class="src src-python">a, = plt.plot<span style="color: #2aa198;">(</span>x,y<span style="color: #2aa198;">)</span>
plt.legend<span style="color: #2aa198;">(</span><span style="color: #b58900;">[</span>a<span style="color: #b58900;">]</span>,<span style="color: #b58900;">[</span><span style="color: #2aa198;">"a"</span><span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2d08fb4" class="outline-3">
<h3 id="org2d08fb4"><span class="section-number-3">4.5</span> 并行化画图时,解决爆内存和同一图中画了好多线的方法</h3>
<div class="outline-text-3" id="text-4-5">
<ol class="org-ol">
<li>利用随机数做画图编号</li>
<li>画完图要关闭这个图</li>
</ol>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">from</span> random <span style="color: #859900; font-weight: bold;">import</span> randint
<span style="color: #268bd2;">fig_num</span> = randint<span style="color: #2aa198;">(</span>0,10**10<span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">fig</span> = plt.figure<span style="color: #2aa198;">(</span>fig_num<span style="color: #2aa198;">)</span>
cop, = plt.plot<span style="color: #2aa198;">(</span>tlist,na,label=<span style="color: #2aa198;">"$a^\\dagger a$"</span><span style="color: #2aa198;">)</span>
z2p, = plt.plot<span style="color: #2aa198;">(</span>tlist,co,label=<span style="color: #2aa198;">"concurrence"</span><span style="color: #2aa198;">)</span>
plt.legend<span style="color: #2aa198;">(</span><span style="color: #b58900;">[</span>cop,z2p<span style="color: #b58900;">]</span>,<span style="color: #b58900;">[</span><span style="color: #2aa198;">"$a^\\dagger a$"</span>,<span style="color: #2aa198;">"concurrence"</span><span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">fig</span> = plt.gcf<span style="color: #2aa198;">()</span>
fig.savefig<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'filename.png'</span><span style="color: #2aa198;">)</span>
plt.close<span style="color: #2aa198;">(</span>fig_num<span style="color: #2aa198;">)</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orga4d2d9d" class="outline-3">
<h3 id="orga4d2d9d"><span class="section-number-3">4.6</span> 让画出来的图片连在一起动起来的方法</h3>
<div class="outline-text-3" id="text-4-6">
<p>
matplotlib本身并不能实现这个功能,可以采用的方法有ffmpeg, opencv, imagemagic等,这里选用最简单方便的imagemagic
</p>
<div class="org-src-container">
<pre class="src src-bash">convert -delay 10 -loop 0 a1.png a2.png a.gif
</pre>
</div>
<p>
选项含义:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">选项</td>
<td class="org-left">意义</td>
</tr>

<tr>
<td class="org-left"><code>-delay 10</code></td>
<td class="org-left">每张图片延时</td>
</tr>

<tr>
<td class="org-left"><code>-loop 0</code></td>
<td class="org-left">循环播放次数,0为一直循环</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgc6bad17" class="outline-3">
<h3 id="orgc6bad17"><span class="section-number-3">4.7</span> 保存图片时超出的部分存不上</h3>
<div class="outline-text-3" id="text-4-7">
<div class="org-src-container">
<pre class="src src-python">plt.tight_layout<span style="color: #2aa198;">(</span>pad=0,rect=<span style="color: #b58900;">(</span>0,0,1,1<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span> <span style="color: #93a1a1;"># </span><span style="color: #93a1a1;">&#35774;&#32622;&#20445;&#23384;&#22270;&#29255;&#30340;&#36793;&#32536;&#22823;&#23567;</span>
plt.savefig<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"fig"</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc72800a" class="outline-3">
<h3 id="orgc72800a"><span class="section-number-3">4.8</span> 保存图片时没有 <code>suptitle</code> 部分</h3>
<div class="outline-text-3" id="text-4-8">
<p>
在 <code>savefig</code> 时加上它，参见 <a href="https://stackoverflow.com/questions/33414819/matplotlib-doesnt-save-suptitle">Matplotlib doesn't save suptitle</a>
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #268bd2;">true_vals</span> = <span style="color: #2aa198;">[</span>1,2,3<span style="color: #2aa198;">]</span>

<span style="color: #268bd2;">f</span>, <span style="color: #268bd2;">ax_arr</span> = plt.subplots<span style="color: #2aa198;">(</span>1,3,figsize=<span style="color: #b58900;">(</span>15,5<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">ax_arr</span> = ax_arr.reshape<span style="color: #2aa198;">(</span>-1<span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">my_suptitle</span> = f.suptitle<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"This is my suptitle\nThis is the second line"</span>, fontsize=20, y=1.1<span style="color: #2aa198;">)</span> 
<span style="color: #93a1a1;"># </span><span style="color: #93a1a1;">y is set to 1.1 to keep the second line in the suptitle from hitting the top of the subplots.</span>

<span style="color: #859900; font-weight: bold;">for</span> idx, i <span style="color: #859900; font-weight: bold;">in</span> <span style="color: #657b83; font-weight: bold;">enumerate</span><span style="color: #2aa198;">(</span>true_vals<span style="color: #2aa198;">)</span>:
<span style="background-color: #eee8d5;"> </span>   ax_arr<span style="color: #2aa198;">[</span>idx<span style="color: #2aa198;">]</span>.boxplot<span style="color: #2aa198;">(</span>data<span style="color: #b58900;">[</span>:,idx<span style="color: #b58900;">]</span>, labels=i<span style="color: #2aa198;">)</span>

f.savefig<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'suptitle_test.pdf'</span>, dpi=f.dpi, bbox_inches=<span style="color: #2aa198;">'tight'</span>,bbox_extra_artists=<span style="color: #b58900;">[</span>my_suptitle<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge3bdadf" class="outline-3">
<h3 id="orge3bdadf"><span class="section-number-3">4.9</span> 设置默认绘图样式</h3>
<div class="outline-text-3" id="text-4-9">
</div>
<div id="outline-container-orge1353f5" class="outline-4">
<h4 id="orge1353f5"><span class="section-number-4">4.9.1</span> 设置全局样式</h4>
<div class="outline-text-4" id="text-4-9-1">
<p>
用 <code>matplotlib.get_configdir()</code> 查看设置文件路径, 一般可能是 <code>$HOME/.config/matplotlib</code>
在这个路径新建文件 <code>matplotlibrc</code> 在这里设置, 相见 <a href="https://matplotlib.org/tutorials/introductory/customizing.html#customizing-with-matplotlibrc-files">文档</a>
下面的内容会设置字体和大小
</p>
<pre class="example">
mathtext.it :sans:italic
mathtext.fontset :custom
font.family :Times New Roman
font.style :normal
font.sans-serif :Liberation Serif
font.size :12
</pre>
</div>
</div>

<div id="outline-container-org5da83d8" class="outline-4">
<h4 id="org5da83d8"><span class="section-number-4">4.9.2</span> 设置和使用局部样式</h4>
<div class="outline-text-4" id="text-4-9-2">
<p>
在设置路径中新建文件夹 <code>$HOME/.config/matplotlib/stylelib</code> 
并在这个文件夹中新建样式文件 <code>name.mplstyle</code>
内容规则同全局样式.
使用方法:
</p>
<ol class="org-ol">
<li>局部使用</li>
</ol>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">with</span> plt.style.context<span style="color: #2aa198;">(</span><span style="color: #b58900;">[</span><span style="color: #2aa198;">'dark_background'</span><span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>:
<span style="background-color: #eee8d5;"> </span>   plt.plot<span style="color: #2aa198;">(</span>x,y<span style="color: #2aa198;">)</span>
<span style="background-color: #eee8d5;"> </span>   plt.show<span style="color: #2aa198;">()</span>
</pre>
</div>
<ol class="org-ol">
<li>全局使用</li>
</ol>
<div class="org-src-container">
<pre class="src src-python">plt.style.use<span style="color: #2aa198;">(</span><span style="color: #b58900;">[</span><span style="color: #2aa198;">'style1'</span>,<span style="color: #2aa198;">'style2'</span><span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2974341" class="outline-3">
<h3 id="org2974341"><span class="section-number-3">4.10</span> 在 JupyterLab 里让图动起来</h3>
<div class="outline-text-3" id="text-4-10">
<p>
见 <a href="https://github.com/matplotlib/ipympl">https://github.com/matplotlib/ipympl</a>
要安装 
</p>
<div class="org-src-container">
<pre class="src src-bash">pip install ipympl

jupyter labextension install @jupyter-widgets/jupyterlab-manager jupyter-matplotlib
</pre>
</div>

<p>
然后在每次画图前写上 
</p>
<div class="org-src-container">
<pre class="src src-python">%matplotlib widget
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orge98542d" class="outline-2">
<h2 id="orge98542d"><span class="section-number-2">5</span> seaborn</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org577843c" class="outline-3">
<h3 id="org577843c"><span class="section-number-3">5.1</span> 设置样式</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">import</span> seaborn <span style="color: #859900; font-weight: bold;">as</span> sns
sns.<span style="color: #657b83; font-weight: bold;">set</span><span style="color: #2aa198;">()</span>
sns.set_palette<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'muted'</span>,8<span style="color: #2aa198;">)</span>
sns.set_style<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"whitegrid"</span><span style="color: #2aa198;">)</span>
sns.set_context<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"notebook"</span><span style="color: #2aa198;">)</span>
</pre>
</div>

<p>
其中 <code>set_palette</code> 为<a href="https://seaborn.pydata.org/tutorial/color_palettes.html">设置色盘</a>；
<code>set_style</code> 为 <a href="https://seaborn.pydata.org/generated/seaborn.set_style.html">设置样式</a>，有无网格线等等；
<code>set_context</code> 为 <a href="https://seaborn.pydata.org/generated/seaborn.set_context.html">设置环境</a>，即字号大小等。
</p>
</div>
</div>

<div id="outline-container-orge603db8" class="outline-3">
<h3 id="orge603db8"><span class="section-number-3">5.2</span> lineplot</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #268bd2;">data</span> = pd.DataFrame<span style="color: #2aa198;">(</span><span style="color: #b58900;">{</span><span style="color: #2aa198;">"x"</span>: <span style="color: #268bd2;">[</span>1, 2, 3<span style="color: #268bd2;">]</span>, <span style="color: #2aa198;">"y"</span>: <span style="color: #268bd2;">[</span>3, 4, 5<span style="color: #268bd2;">]</span>, <span style="color: #2aa198;">"z"</span>: <span style="color: #268bd2;">[</span>6, 7, 8<span style="color: #268bd2;">]</span><span style="color: #b58900;">}</span><span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">ax</span> = sns.lineplot<span style="color: #2aa198;">(</span>x=<span style="color: #2aa198;">"x"</span>,
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span> y=<span style="color: #2aa198;">"y"</span>,
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span> data=data,
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span> hue=<span style="color: #2aa198;">"z"</span>,
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span> palette=<span style="color: #2aa198;">"pastel"</span>,
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span> legend=<span style="color: #2aa198;">"full"</span><span style="color: #2aa198;">)</span>
ax.set_xlabel<span style="color: #2aa198;">(</span>r<span style="color: #2aa198;">"$x$"</span><span style="color: #2aa198;">)</span>
ax.set_ylabel<span style="color: #2aa198;">(</span>r<span style="color: #2aa198;">"$y$"</span><span style="color: #2aa198;">)</span>
ax.set_title<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"x-y for z"</span><span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">handles</span>, <span style="color: #268bd2;">labels</span> = ax.get_legend_handles_labels<span style="color: #2aa198;">()</span>
ax.legend<span style="color: #2aa198;">(</span>handles=handles<span style="color: #b58900;">[</span>1:<span style="color: #b58900;">]</span>, labels=labels<span style="color: #b58900;">[</span>1:<span style="color: #b58900;">]</span>, title=<span style="color: #2aa198;">"z"</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7d7f94c" class="outline-3">
<h3 id="org7d7f94c"><span class="section-number-3">5.3</span> heatmap</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #268bd2;">data</span> = pd.DataFrame<span style="color: #2aa198;">(</span><span style="color: #b58900;">{</span><span style="color: #2aa198;">"x"</span>: <span style="color: #268bd2;">[</span>1, 2, 3<span style="color: #268bd2;">]</span>, <span style="color: #2aa198;">"y"</span>: <span style="color: #268bd2;">[</span>3, 4, 5<span style="color: #268bd2;">]</span>, <span style="color: #2aa198;">"z"</span>: <span style="color: #268bd2;">[</span>6, 7, 8<span style="color: #268bd2;">]</span><span style="color: #b58900;">}</span><span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">d</span> = data.pivot<span style="color: #2aa198;">(</span>index=<span style="color: #2aa198;">"x"</span>, columns=<span style="color: #2aa198;">"y"</span>, values=<span style="color: #2aa198;">"z"</span><span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">ax</span> = sns.heatmap<span style="color: #2aa198;">(</span>d<span style="color: #2aa198;">)</span>
ax.invert_yaxis<span style="color: #2aa198;">()</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org559cc1b" class="outline-2">
<h2 id="org559cc1b"><span class="section-number-2">6</span> bokeh</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org919eb83" class="outline-3">
<h3 id="org919eb83"><span class="section-number-3">6.1</span> 基本示例</h3>
<div class="outline-text-3" id="text-6-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #93a1a1;"># </span><span style="color: #93a1a1;">&#23548;&#20837;</span>
<span style="color: #859900; font-weight: bold;">from</span> bokeh.plotting <span style="color: #859900; font-weight: bold;">import</span> figure,show,output_notebook
output_notebook<span style="color: #2aa198;">()</span>

<span style="color: #93a1a1;"># </span><span style="color: #93a1a1;">&#35745;&#31639;</span>
<span style="color: #859900; font-weight: bold;">import</span> numpy <span style="color: #859900; font-weight: bold;">as</span> np
<span style="color: #268bd2;">x</span> = np.linspace<span style="color: #2aa198;">(</span>0,10,100<span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">y</span> = np.exp<span style="color: #2aa198;">(</span>x<span style="color: #2aa198;">)</span>

<span style="color: #93a1a1;"># </span><span style="color: #93a1a1;">&#30011;&#22270;</span>
<span style="color: #268bd2;">p</span> = figure<span style="color: #2aa198;">(</span>x_axis_label=<span style="color: #2aa198;">"x"</span>, y_axis_label=<span style="color: #2aa198;">"y"</span>,y_axis_type=<span style="color: #2aa198;">"log"</span>,title=<span style="color: #2aa198;">"title"</span><span style="color: #2aa198;">)</span>
p.line<span style="color: #2aa198;">(</span>x=x,y=y,legend_label=<span style="color: #2aa198;">"line"</span><span style="color: #2aa198;">)</span>
show<span style="color: #2aa198;">(</span>p<span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgc6655aa" class="outline-2">
<h2 id="orgc6655aa"><span class="section-number-2">7</span> jupyter</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-orge492349" class="outline-3">
<h3 id="orge492349"><span class="section-number-3">7.1</span> 常用模板</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">import</span> numpy <span style="color: #859900; font-weight: bold;">as</span> np
<span style="color: #859900; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #859900; font-weight: bold;">as</span> plt
<span style="color: #859900; font-weight: bold;">import</span> seaborn <span style="color: #859900; font-weight: bold;">as</span> sns
<span style="color: #859900; font-weight: bold;">from</span> ipywidgets <span style="color: #859900; font-weight: bold;">import</span> interact, widgets
<span style="color: #859900; font-weight: bold;">from</span> bokeh.plotting <span style="color: #859900; font-weight: bold;">import</span> figure,show,output_notebook
<span style="color: #859900; font-weight: bold;">from</span> tqdm <span style="color: #859900; font-weight: bold;">import</span> tqdm
sns.<span style="color: #657b83; font-weight: bold;">set</span><span style="color: #2aa198;">()</span>
sns.set_palette<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'muted'</span><span style="color: #2aa198;">)</span>
sns.set_style<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"whitegrid"</span><span style="color: #2aa198;">)</span>
sns.set_context<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"notebook"</span><span style="color: #2aa198;">)</span>
np.set_printoptions<span style="color: #2aa198;">(</span>suppress=<span style="color: #268bd2; font-weight: bold;">True</span>, precision=4<span style="color: #2aa198;">)</span>
output_notebook<span style="color: #2aa198;">()</span>
%load_ext autoreload
%autoreload 2
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc9895de" class="outline-3">
<h3 id="orgc9895de"><span class="section-number-3">7.2</span> 有用的插件</h3>
<div class="outline-text-3" id="text-7-2">
<ol class="org-ol">
<li><a href="https://github.com/jupyterlab/jupyterlab-toc">@jupyterlab/toc</a> : 目录，必备</li>
<li><a href="https://github.com/ryantam626/jupyterlab_code_formatter">jupyterlab<sub>code</sub><sub>formatter</sub></a> : 格式化代码，必备</li>
<li><a href="https://github.com/jupyterlab/jupyter-renderers">@jupyterlab/katex-extension</a> : 使用 katex 渲染数学公式，速度能稍微快一点</li>
<li><a href="https://github.com/jupyterlab/jupyterlab-git">@jupyterlab/git</a> : 在网页上方便的使用git，还是要习惯用这个做后悔药</li>
<li><a href="https://github.com/jupyter/nbdime">nbdime</a> : 用来比较ipynb的不同处，git必备</li>
<li><a href="https://github.com/mwouts/jupytext">jupytext</a> : 同步ipynb文件和对应的py文件，某些情况下有用</li>
</ol>
</div>
</div>

<div id="outline-container-orgfe68c84" class="outline-3">
<h3 id="orgfe68c84"><span class="section-number-3">7.3</span> 在jupyter中使用ipdb</h3>
<div class="outline-text-3" id="text-7-3">
<ol class="org-ol">
<li>在某位置设断点的方法</li>
</ol>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">from</span> IPython.core.debugger <span style="color: #859900; font-weight: bold;">import</span> Tracer
Tracer<span style="color: #2aa198;">()()</span><span style="color: #93a1a1;">#</span><span style="color: #93a1a1;">&#26029;&#28857;</span>
</pre>
</div>
<ol class="org-ol">
<li>出错自动进入ipdb模式</li>
</ol>
<div class="org-src-container">
<pre class="src src-python">%pdb
</pre>
</div>
</div>
</div>

<div id="outline-container-orgec8ea65" class="outline-3">
<h3 id="orgec8ea65"><span class="section-number-3">7.4</span> 运行时间分析</h3>
<div class="outline-text-3" id="text-7-4">
<p>
得到执行单个cell用时,在开始处添加 <code>%%time</code>
</p>
</div>
</div>

<div id="outline-container-orgdea690b" class="outline-3">
<h3 id="orgdea690b"><span class="section-number-3">7.5</span> 使用 JavaScript</h3>
<div class="outline-text-3" id="text-7-5">
</div>
<div id="outline-container-org6ab4bc2" class="outline-4">
<h4 id="org6ab4bc2"><span class="section-number-4">7.5.1</span> 创建 DOM</h4>
<div class="outline-text-4" id="text-7-5-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">import</span> ipywidgets
ipywidgets.HTML<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'''&lt;div id="echarts" style="width: 600px;height:400px;"&gt;&lt;/div&gt;'''</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0cc67ec" class="outline-4">
<h4 id="org0cc67ec"><span class="section-number-4">7.5.2</span> 执行 js 语句</h4>
<div class="outline-text-4" id="text-7-5-2">
</div>
<ol class="org-ol">
<li><a id="org9978af2"></a>使用魔术指令<br />
<div class="outline-text-5" id="text-7-5-2-1">
<div class="org-src-container">
<pre class="src src-javascript">%%javascript
<span style="color: #859900; font-weight: bold;">var</span> <span style="color: #268bd2;">s</span> = document.createElement<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'script'</span><span style="color: #2aa198;">)</span>;
s.src = <span style="color: #2aa198;">"https://cdn.bootcss.com/echarts/4.2.0-rc.2/echarts.min.js"</span>;
document.getElementsByTagName<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"head"</span><span style="color: #2aa198;">)[</span>0<span style="color: #2aa198;">]</span>.appendChild<span style="color: #2aa198;">(</span>s<span style="color: #2aa198;">)</span>;
<span style="color: #859900; font-weight: bold;">var</span> <span style="color: #268bd2;">myChart</span> = echarts.init<span style="color: #2aa198;">(</span>document.getElementById<span style="color: #b58900;">(</span><span style="color: #2aa198;">'echarts'</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>;

<span style="color: #859900; font-weight: bold;">var</span> <span style="color: #268bd2;">option</span> = <span style="color: #2aa198;">{</span>
    title: <span style="color: #b58900;">{</span>
        text: <span style="color: #2aa198;">'ECharts &#20837;&#38376;&#31034;&#20363;'</span>
    <span style="color: #b58900;">}</span>,
    tooltip: <span style="color: #b58900;">{}</span>,
    legend: <span style="color: #b58900;">{</span>
        data:<span style="color: #268bd2;">[</span><span style="color: #2aa198;">'&#38144;&#37327;'</span><span style="color: #268bd2;">]</span>
    <span style="color: #b58900;">}</span>,
    xAxis: <span style="color: #b58900;">{</span>
        data: <span style="color: #268bd2;">[</span><span style="color: #2aa198;">"&#34924;&#34923;"</span>,<span style="color: #2aa198;">"&#32650;&#27611;&#34923;"</span>,<span style="color: #2aa198;">"&#38634;&#32442;&#34923;"</span>,<span style="color: #2aa198;">"&#35044;&#23376;"</span>,<span style="color: #2aa198;">"&#39640;&#36319;&#38795;"</span>,<span style="color: #2aa198;">"&#34972;&#23376;"</span><span style="color: #268bd2;">]</span>
    <span style="color: #b58900;">}</span>,
    yAxis: <span style="color: #b58900;">{}</span>,
    series: <span style="color: #b58900;">[</span><span style="color: #268bd2;">{</span>
        name: <span style="color: #2aa198;">'&#38144;&#37327;'</span>,
        type: <span style="color: #2aa198;">'bar'</span>,
        data: <span style="color: #6c71c4;">[</span>5, 20, 36, 10, 10, 20<span style="color: #6c71c4;">]</span>
    <span style="color: #268bd2;">}</span><span style="color: #b58900;">]</span>
<span style="color: #2aa198;">}</span>;

myChart.setOption<span style="color: #2aa198;">(</span>option<span style="color: #2aa198;">)</span>;
</pre>
</div>
</div>
</li>

<li><a id="org2d42de4"></a>使用 python<br />
<div class="outline-text-5" id="text-7-5-2-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">from</span> IPython.display <span style="color: #859900; font-weight: bold;">import</span> Javascript
Javascript<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'''</span>
<span style="color: #2aa198;">var s = document.createElement('script');</span>
<span style="color: #2aa198;">s.src = "https://cdn.bootcss.com/echarts/4.2.0-rc.2/echarts.min.js";</span>
<span style="color: #2aa198;">document.getElementsByTagName("head")[0].appendChild(s);</span>
<span style="color: #2aa198;">var myChart = echarts.init(document.getElementById('echarts'));</span>

<span style="color: #2aa198;">var option = {</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   title: {</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   </span><span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   text: 'ECharts &#20837;&#38376;&#31034;&#20363;'</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   },</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   tooltip: {},</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   legend: {</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   </span><span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   data:['&#38144;&#37327;']</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   },</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   xAxis: {</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   </span><span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   data: ["&#34924;&#34923;","&#32650;&#27611;&#34923;","&#38634;&#32442;&#34923;","&#35044;&#23376;","&#39640;&#36319;&#38795;","&#34972;&#23376;"]</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   },</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   yAxis: {},</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   series: [{</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   </span><span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   name: '&#38144;&#37327;',</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   </span><span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   type: 'bar',</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   </span><span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   data: [5, 20, 36, 10, 10, 20]</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   }]</span>
<span style="color: #2aa198;">};</span>

<span style="color: #2aa198;">myChart.setOption(option);</span>
<span style="color: #2aa198;">'''</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</li>

<li><a id="org5f06192"></a>从 CDN 加载 js 文件<br />
<div class="outline-text-5" id="text-7-5-2-3">
<p>
三个语句，哪个都不能缺
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #859900; font-weight: bold;">var</span> <span style="color: #268bd2;">s</span> = document.createElement<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'script'</span><span style="color: #2aa198;">)</span>;
s.src = <span style="color: #2aa198;">"https://cdn.bootcss.com/echarts/4.2.0-rc.2/echarts.min.js"</span>;
document.getElementsByTagName<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"head"</span><span style="color: #2aa198;">)[</span>0<span style="color: #2aa198;">]</span>.appendChild<span style="color: #2aa198;">(</span>s<span style="color: #2aa198;">)</span>;
</pre>
</div>
</div>
</li>

<li><a id="org62985c6"></a>通用方法<br />
<div class="outline-text-5" id="text-7-5-2-4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">from</span> IPython.display <span style="color: #859900; font-weight: bold;">import</span> Javascript
Javascript<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'''</span>
<span style="color: #2aa198;">var s = document.createElement('script');</span>
<span style="color: #2aa198;">s.src = "http://www.echartsjs.com/dist/echarts.js";</span>
<span style="color: #2aa198;">document.getElementsByTagName("head")[0].appendChild(s);</span>
<span style="color: #2aa198;">var s = document.createElement('script');</span>
<span style="color: #2aa198;">s.src = "http://www.echartsjs.com/dist/echarts-gl.js";</span>
<span style="color: #2aa198;">document.getElementsByTagName("head")[0].appendChild(s);'''</span><span style="color: #2aa198;">)</span>


<span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">javascript_text</span><span style="color: #2aa198;">(</span>text<span style="color: #2aa198;">)</span>:
<span style="background-color: #eee8d5;"> </span>   <span style="color: #268bd2;">text</span> = <span style="color: #2aa198;">(</span><span style="color: #2aa198;">"""</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   var s = document.createElement('script');</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   s.text = `{}`;</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   document.getElementsByTagName("head")[0].appendChild(s);</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   """</span>.<span style="color: #657b83; font-weight: bold;">format</span><span style="color: #b58900;">(</span>text<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>
<span style="background-color: #eee8d5;"> </span>   <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #2aa198;">(</span>text<span style="color: #2aa198;">)</span>


Javascript<span style="color: #2aa198;">(</span>javascript_text<span style="color: #b58900;">(</span><span style="color: #2aa198;">'alert("asd");'</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org03f8580" class="outline-3">
<h3 id="org03f8580"><span class="section-number-3">7.6</span> 动态组件 ipywidgets</h3>
<div class="outline-text-3" id="text-7-6">
</div>
<div id="outline-container-org9fe71f7" class="outline-4">
<h4 id="org9fe71f7"><span class="section-number-4">7.6.1</span> 安装</h4>
<div class="outline-text-4" id="text-7-6-1">
<p>
对于 notebook
</p>
<pre class="example">
pip install ipywidgets
jupyter nbextension enable --py widgetsnbextension
</pre>

<p>
对于 lab
</p>
<div class="org-src-container">
<pre class="src src-bash">pip install ipywidgets
jupyter labextension install @jupyter-widgets/jupyterlab-manager
</pre>
</div>
</div>
</div>

<div id="outline-container-org9ff2a58" class="outline-4">
<h4 id="org9ff2a58"><span class="section-number-4">7.6.2</span> 基本动态组件 - 使用 interact</h4>
<div class="outline-text-4" id="text-7-6-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">from</span> ipywidgets <span style="color: #859900; font-weight: bold;">import</span> interact, widgets

<span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">f</span><span style="color: #2aa198;">(</span>x<span style="color: #2aa198;">)</span>:
<span style="background-color: #eee8d5;"> </span>   <span style="color: #859900; font-weight: bold;">return</span> x+100

interact<span style="color: #2aa198;">(</span>f, x=10<span style="color: #2aa198;">)</span>
</pre>
</div>

<p>
或者定制组件范围
</p>
<div class="org-src-container">
<pre class="src src-python">interact<span style="color: #2aa198;">(</span>f, x=widgets.FloatSlider<span style="color: #b58900;">(</span><span style="color: #657b83; font-weight: bold;">min</span>=0,<span style="color: #657b83; font-weight: bold;">max</span>=100,description=<span style="color: #2aa198;">"asd:"</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org055998b" class="outline-3">
<h3 id="org055998b"><span class="section-number-3">7.7</span> 自动重加载库</h3>
<div class="outline-text-3" id="text-7-7">
<div class="org-src-container">
<pre class="src src-python">%load_ext autoreload 
%autoreload 2
</pre>
</div>
</div>
</div>

<div id="outline-container-org3838c8c" class="outline-3">
<h3 id="org3838c8c"><span class="section-number-3">7.8</span> nbdime：diff 工具</h3>
<div class="outline-text-3" id="text-7-8">
</div>
<div id="outline-container-orgf66f69c" class="outline-4">
<h4 id="orgf66f69c"><span class="section-number-4">7.8.1</span> 安装</h4>
<div class="outline-text-4" id="text-7-8-1">
<ol class="org-ol">
<li>安装 <code>pip install nbdime</code></li>
<li>启用 git <code>nbdime config-git --enable --global</code></li>
</ol>
</div>
</div>

<div id="outline-container-org379adf8" class="outline-4">
<h4 id="org379adf8"><span class="section-number-4">7.8.2</span> 基本使用</h4>
<div class="outline-text-4" id="text-7-8-2">
<ol class="org-ol">
<li>比较 <code>nbdiff notebook_1.ipynb notebook_2.ipynb</code></li>
<li>网页端显示比较 <code>nbdiff-web notebook_1.ipynb notebook_2.ipynb</code></li>
</ol>
</div>
</div>
</div>
</div>


<div id="outline-container-org34e7237" class="outline-2">
<h2 id="org34e7237"><span class="section-number-2">8</span> cython</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-orgef01551" class="outline-3">
<h3 id="orgef01551"><span class="section-number-3">8.1</span> 编译</h3>
<div class="outline-text-3" id="text-8-1">
<p>
<code>setup.py</code> 文件， <code>python3 setup.py build_ext -i</code>
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">from</span> distutils.core <span style="color: #859900; font-weight: bold;">import</span> setup
<span style="color: #859900; font-weight: bold;">from</span> distutils.extension <span style="color: #859900; font-weight: bold;">import</span> Extension
<span style="color: #859900; font-weight: bold;">from</span> Cython.Build <span style="color: #859900; font-weight: bold;">import</span> cythonize
<span style="color: #859900; font-weight: bold;">import</span> numpy

setup<span style="color: #2aa198;">(</span>ext_modules=cythonize<span style="color: #b58900;">(</span><span style="color: #268bd2;">[</span>
<span style="background-color: #eee8d5;"> </span>   Extension<span style="color: #6c71c4;">(</span><span style="color: #2aa198;">"f"</span>, <span style="color: #859900;">[</span><span style="color: #2aa198;">"f.pyx"</span><span style="color: #859900;">]</span>,
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span> libraries=<span style="color: #859900;">[</span><span style="color: #2aa198;">"f"</span><span style="color: #859900;">]</span>,
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span> runtime_library_dirs=<span style="color: #859900;">[</span><span style="color: #2aa198;">"."</span><span style="color: #859900;">]</span>,
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span> include_dirs=<span style="color: #859900;">[</span>numpy.get_include<span style="color: #b58900;">()</span><span style="color: #859900;">]</span>,
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span> library_dirs=<span style="color: #859900;">[</span><span style="color: #2aa198;">"."</span><span style="color: #859900;">]</span><span style="color: #6c71c4;">)</span>
<span style="color: #268bd2;">]</span>,
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   language_level=3<span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org41fc406" class="outline-3">
<h3 id="org41fc406"><span class="section-number-3">8.2</span> 与 numpy 的结合</h3>
<div class="outline-text-3" id="text-8-2">
</div>
<div id="outline-container-orga60bb11" class="outline-4">
<h4 id="orga60bb11"><span class="section-number-4">8.2.1</span> 配置</h4>
<div class="outline-text-4" id="text-8-2-1">
<ol class="org-ol">
<li><code>setup.py</code> 里必须设置 <code>include_dirs</code></li>
</ol>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">import</span> numpy <span style="color: #859900; font-weight: bold;">as</span> np
cimport numpy <span style="color: #859900; font-weight: bold;">as</span> np

</pre>
</div>
</div>
</div>

<div id="outline-container-orge0be5aa" class="outline-4">
<h4 id="orge0be5aa"><span class="section-number-4">8.2.2</span> 类型</h4>
<div class="outline-text-4" id="text-8-2-2">
<ol class="org-ol">
<li>数值类型运行时类型带 t， 一般类型不带 t</li>
<li>数组类型 <code>np.ndarray[np.float_t,ndim=1,mode="c"]</code></li>
</ol>

<div class="org-src-container">
<pre class="src src-python">ctypedef np.float_t FLOAT_t
<span style="color: #268bd2;">FLOAT</span> = np.<span style="color: #657b83; font-weight: bold;">float</span>

cpdef np.ndarray<span style="color: #2aa198;">[</span>FLOAT_t,ndim=1,mode=<span style="color: #2aa198;">"c"</span><span style="color: #2aa198;">]</span> l<span style="color: #2aa198;">()</span>:
<span style="background-color: #eee8d5;"> </span>   cdef np.ndarray<span style="color: #2aa198;">[</span>FLOAT_t,ndim=1,mode=<span style="color: #2aa198;">"c"</span><span style="color: #2aa198;">]</span> z
<span style="background-color: #eee8d5;"> </span>   <span style="color: #268bd2;">z</span> = np.array<span style="color: #2aa198;">(</span><span style="color: #b58900;">[</span>0<span style="color: #b58900;">]</span>,dtype=FLOAT<span style="color: #2aa198;">)</span>
<span style="background-color: #eee8d5;"> </span>   <span style="color: #859900; font-weight: bold;">return</span> z
</pre>
</div>
</div>
</div>

<div id="outline-container-org98eda42" class="outline-4">
<h4 id="org98eda42"><span class="section-number-4">8.2.3</span> 获得指针</h4>
<div class="outline-text-4" id="text-8-2-3">
<ol class="org-ol">
<li><p>
声明指针
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   cdef double<span style="color: #2aa198;">[</span>::1<span style="color: #2aa198;">]</span> <span style="color: #268bd2;">z_memview</span> = z
</pre>
</div></li>
<li><p>
向函数传递指针
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>   cf.l<span style="color: #2aa198;">(</span>&amp;z_memview<span style="color: #b58900;">[</span>0<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>
</pre>
</div></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgb67ae94" class="outline-3">
<h3 id="orgb67ae94"><span class="section-number-3">8.3</span> 向外部 c 函数传递数组</h3>
<div class="outline-text-3" id="text-8-3">
</div>
<div id="outline-container-org04485db" class="outline-4">
<h4 id="org04485db"><span class="section-number-4">8.3.1</span> h 文件中的声明</h4>
<div class="outline-text-4" id="text-8-3-1">
<p>
声明的是数组
</p>
<div class="org-src-container">
<pre class="src src-python">void f<span style="color: #2aa198;">(</span>double result<span style="color: #b58900;">[]</span><span style="color: #2aa198;">)</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb9dc29f" class="outline-4">
<h4 id="orgb9dc29f"><span class="section-number-4">8.3.2</span> pxd 文件中的声明</h4>
<div class="outline-text-4" id="text-8-3-2">
<p>
声明的是指针
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="background-color: #eee8d5;"> </span>   void f<span style="color: #2aa198;">(</span>double* result<span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org24d945d" class="outline-4">
<h4 id="org24d945d"><span class="section-number-4">8.3.3</span> pyx 中的用法</h4>
<div class="outline-text-4" id="text-8-3-3">
<p>
传递的是指针
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="background-color: #eee8d5;"> </span>   cdef double<span style="color: #2aa198;">[</span>::1<span style="color: #2aa198;">]</span> <span style="color: #268bd2;">z_memview</span> = z
<span style="background-color: #eee8d5;"> </span>   cf.l<span style="color: #2aa198;">(</span>&amp;z_memview<span style="color: #b58900;">[</span>0<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>


<div id="outline-container-org80dab03" class="outline-2">
<h2 id="org80dab03"><span class="section-number-2">9</span> pillow: 图像处理</h2>
</div>


<div id="outline-container-org7ac60fd" class="outline-2">
<h2 id="org7ac60fd"><span class="section-number-2">10</span> opencv: 图像处理</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-orgeb037e3" class="outline-3">
<h3 id="orgeb037e3"><span class="section-number-3">10.1</span> 对图片进行切边操作</h3>
<div class="outline-text-3" id="text-10-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">import</span> matplotlib.pyplot <span style="color: #859900; font-weight: bold;">as</span> plt
<span style="color: #859900; font-weight: bold;">import</span> cv2
<span style="color: #859900; font-weight: bold;">import</span> numpy <span style="color: #859900; font-weight: bold;">as</span> np

<span style="color: #268bd2;">text</span> = r<span style="color: #2aa198;">"\frac{1}{2}"</span>
<span style="color: #268bd2;">file_name</span> = <span style="color: #2aa198;">"fi.png"</span>

<span style="color: #93a1a1;"># </span><span style="color: #93a1a1;">make math text</span>
plt.figure<span style="color: #2aa198;">(</span>figsize=<span style="color: #b58900;">(</span>5, 5<span style="color: #b58900;">)</span>, dpi=300<span style="color: #2aa198;">)</span>
plt.axis<span style="color: #2aa198;">(</span><span style="color: #2aa198;">'off'</span><span style="color: #2aa198;">)</span>
plt.text<span style="color: #2aa198;">(</span>
<span style="background-color: #eee8d5;"> </span>   0, 0, text.replace<span style="color: #b58900;">(</span>r<span style="color: #2aa198;">'\['</span>, r<span style="color: #2aa198;">'$'</span><span style="color: #b58900;">)</span>.replace<span style="color: #b58900;">(</span>r<span style="color: #2aa198;">'\]'</span>, r<span style="color: #2aa198;">'$'</span><span style="color: #b58900;">)</span>, ha=<span style="color: #2aa198;">'left'</span>, wrap=<span style="color: #268bd2; font-weight: bold;">True</span><span style="color: #2aa198;">)</span>
plt.savefig<span style="color: #2aa198;">(</span>file_name, bbox_inches=<span style="color: #2aa198;">'tight'</span>, transparent=<span style="color: #268bd2; font-weight: bold;">True</span><span style="color: #2aa198;">)</span>

<span style="color: #93a1a1;"># </span><span style="color: #93a1a1;">cut white side</span>
<span style="color: #268bd2;">img</span> = cv2.imread<span style="color: #2aa198;">(</span>file_name<span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">img2gray</span> = cv2.cvtColor<span style="color: #2aa198;">(</span>img, cv2.COLOR_BGR2GRAY<span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">indexes</span> = np.argwhere<span style="color: #2aa198;">(</span>img2gray &lt; 255<span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">x_min</span> = <span style="color: #657b83; font-weight: bold;">min</span><span style="color: #2aa198;">(</span>indexes<span style="color: #b58900;">[</span>:, 0<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">x_max</span> = <span style="color: #657b83; font-weight: bold;">max</span><span style="color: #2aa198;">(</span>indexes<span style="color: #b58900;">[</span>:, 0<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">y_min</span> = <span style="color: #657b83; font-weight: bold;">min</span><span style="color: #2aa198;">(</span>indexes<span style="color: #b58900;">[</span>:, 1<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">y_max</span> = <span style="color: #657b83; font-weight: bold;">max</span><span style="color: #2aa198;">(</span>indexes<span style="color: #b58900;">[</span>:, 1<span style="color: #b58900;">]</span><span style="color: #2aa198;">)</span>
<span style="color: #268bd2;">img_new</span> = img<span style="color: #2aa198;">[</span>x_min:x_max, y_min:y_max<span style="color: #2aa198;">]</span>
cv2.imwrite<span style="color: #2aa198;">(</span>file_name, img_new<span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org6b0807c" class="outline-2">
<h2 id="org6b0807c"><span class="section-number-2">11</span> ctypes: c 互操作标准库</h2>
<div class="outline-text-2" id="text-11">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>import ctypes</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>asd=ctypes.CDLL("a.so")</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>asd.haha(2)</code></td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org5a767c3" class="outline-2">
<h2 id="org5a767c3"><span class="section-number-2">12</span> cffi: c/c++ 互操作</h2>
<div class="outline-text-2" id="text-12">
<p>
cffi 是用来直接包裹 c 函数的库，与 ctypes 功能相同，不能将 python 编译成 c，即与 cython 不同
</p>
</div>
<div id="outline-container-org3843369" class="outline-3">
<h3 id="org3843369"><span class="section-number-3">12.1</span> 基本使用</h3>
<div class="outline-text-3" id="text-12-1">
</div>
<div id="outline-container-org27eb6a7" class="outline-4">
<h4 id="org27eb6a7"><span class="section-number-4">12.1.1</span> 内联调用方式</h4>
<div class="outline-text-4" id="text-12-1-1">
<div class="org-src-container">
<pre class="src src-python"><span style="background-color: #eee8d5;"> </span><span style="color: #859900; font-weight: bold;">import</span> cffi

<span style="background-color: #eee8d5;"> </span><span style="color: #268bd2;">ffi</span> = cffi.FFI<span style="color: #2aa198;">()</span>
<span style="background-color: #eee8d5;"> </span>ffi.cdef<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"""void f(double result[],double a_r, double a_i, double b_r, double b_i, double t,</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   </span><span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   double Delta, double omega, double c_var, double A,</span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   </span><span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   double epsilon_0);         </span>
<span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   </span><span style="color: #2aa198; background-color: #eee8d5;"> </span><span style="color: #2aa198;">   """</span><span style="color: #2aa198;">)</span>
<span style="background-color: #eee8d5;"> </span><span style="color: #268bd2;">lib</span> = ffi.dlopen<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"./libf.so"</span><span style="color: #2aa198;">)</span>

<span style="background-color: #eee8d5;"> </span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">cf</span><span style="color: #2aa198;">(</span>t,y,Delta,omega,c,A,epslion_0<span style="color: #2aa198;">)</span>:
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span><span style="color: #268bd2;">tt</span> = ffi.new<span style="color: #2aa198;">(</span><span style="color: #2aa198;">"double[4]"</span><span style="color: #2aa198;">)</span>
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span>lib.f<span style="color: #2aa198;">(</span>tt,y<span style="color: #b58900;">[</span>0<span style="color: #b58900;">]</span>,y<span style="color: #b58900;">[</span>1<span style="color: #b58900;">]</span>,y<span style="color: #b58900;">[</span>2<span style="color: #b58900;">]</span>,y<span style="color: #b58900;">[</span>3<span style="color: #b58900;">]</span>,t,Delta,omega,c,A,epslion_0<span style="color: #2aa198;">)</span>
<span style="background-color: #eee8d5;"> </span>   <span style="background-color: #eee8d5;"> </span><span style="color: #859900; font-weight: bold;">return</span> <span style="color: #657b83; font-weight: bold;">list</span><span style="color: #2aa198;">(</span>tt<span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org30946f0" class="outline-2">
<h2 id="org30946f0"><span class="section-number-2">13</span> pytesseract: OCR 识别库</h2>
<div class="outline-text-2" id="text-13">
<ol class="org-ol">
<li>参见 <a href="https://github.com/madmaze/pytesseract">madmaze/pytesseract</a></li>
<li>首先要安装 tesseract</li>
</ol>

<p>
示例如下：
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold;">import</span> pytesseract
<span style="color: #859900; font-weight: bold;">from</span> PIL <span style="color: #859900; font-weight: bold;">import</span> Image
<span style="color: #859900; font-weight: bold;">print</span><span style="color: #2aa198;">(</span>pytesseract.image_to_string<span style="color: #b58900;">(</span>Image.<span style="color: #657b83; font-weight: bold;">open</span><span style="color: #268bd2;">(</span><span style="color: #2aa198;">'a.png'</span><span style="color: #268bd2;">)</span><span style="color: #b58900;">)</span><span style="color: #2aa198;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: chimez</p>
<p class="date">Created: 2020-09-27 Sun 17:24</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
