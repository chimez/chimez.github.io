<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-12-19 Sat 14:08 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Python科学计算</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="chimez" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="static/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="static/readtheorg_theme/css/readtheorg.css"/>
<script type="text/javascript" static="static/lib/js/jquery.min.js"></script>
<script type="text/javascript" static="static/lib/js/bootstrap.min.js"></script>
<script type="text/javascript" static="static/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" static="static/readtheorg_theme/js/readtheorg.js"></script>
<style> #content{max-width:1800px;}</style>
<style> p{max-width:800px;}</style>
<style> li{max-width:800px;}</style
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Python科学计算</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org3576466">1. numpy</a>
<ul>
<li><a href="#org96f1542">1.1. 启用 MKL 支持</a>
<ul>
<li><a href="#org873bd84">1.1.1. 编译安装OpenBLAS</a></li>
<li><a href="#orga530571">1.1.2. 编译安装numpy</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2ef36fe">2. scipy</a>
<ul>
<li><a href="#org6e71128">2.1. Scipy 的库</a></li>
<li><a href="#org01bc2e1">2.2. scipy.sparse 稀疏矩阵</a>
<ul>
<li><a href="#orga4d7647">2.2.1. 稀疏矩阵格式</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org70990f7">3. pandas</a>
<ul>
<li><a href="#org6efd920">3.1. 数据表格和矩阵之间的转换</a>
<ul>
<li><a href="#org7741dc2">3.1.1. 从点的坐标表格 <code>(x,y,z)</code> 得到矩阵</a></li>
<li><a href="#org1ce6f6b">3.1.2. 从矩阵表格得到坐标表格</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org565ab03">4. matplotlib</a>
<ul>
<li><a href="#org4436566">4.1. 画多横线图</a></li>
<li><a href="#org30b8cda">4.2. 画 3D 曲面图</a></li>
<li><a href="#org3434daf">4.3. 画 3D 箭头场图</a></li>
<li><a href="#orgc860c8b">4.4. matplotlib使用中文与latex</a>
<ul>
<li><a href="#orgf0db9cb">4.4.1. 图片中的文本使用latex符号</a></li>
<li><a href="#orgdf727e5">4.4.2. 中文显示</a></li>
<li><a href="#orgdfa4811">4.4.3. 图注和标签中的数学字体</a></li>
</ul>
</li>
<li><a href="#org54f665b">4.5. Legend中指定线和图例相对应的方法</a></li>
<li><a href="#org2d08fb4">4.6. 并行化画图时,解决爆内存和同一图中画了好多线的方法</a></li>
<li><a href="#orga4d2d9d">4.7. 让画出来的图片连在一起动起来的方法</a></li>
<li><a href="#orgc6bad17">4.8. 保存图片时超出的部分存不上</a></li>
<li><a href="#orgc72800a">4.9. 保存图片时没有 <code>suptitle</code> 部分</a></li>
<li><a href="#orge3bdadf">4.10. 设置默认绘图样式</a>
<ul>
<li><a href="#orge1353f5">4.10.1. 设置全局样式</a></li>
<li><a href="#org5da83d8">4.10.2. 设置和使用局部样式</a></li>
</ul>
</li>
<li><a href="#org2974341">4.11. 在 JupyterLab 里让图动起来</a></li>
<li><a href="#org4a49653">4.12. 论文图片样式</a>
<ul>
<li><a href="#orgeeb483a">4.12.1. 设置方式</a></li>
<li><a href="#org3d4ae9d">4.12.2. 通用样式 <code>paper.mplstyle</code></a></li>
<li><a href="#orgce939a2">4.12.3. 单栏样式 <code>paper_onecol.mplstyle</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orge98542d">5. seaborn</a>
<ul>
<li><a href="#org577843c">5.1. 设置样式</a></li>
<li><a href="#orge603db8">5.2. lineplot</a></li>
<li><a href="#org7d7f94c">5.3. heatmap</a></li>
</ul>
</li>
<li><a href="#org559cc1b">6. bokeh</a>
<ul>
<li><a href="#org919eb83">6.1. 基本示例</a></li>
</ul>
</li>
<li><a href="#orgc6655aa">7. jupyter</a>
<ul>
<li><a href="#orge492349">7.1. 常用模板</a></li>
<li><a href="#orgc9895de">7.2. 有用的插件</a></li>
<li><a href="#orgfe68c84">7.3. 在jupyter中使用ipdb</a></li>
<li><a href="#orgec8ea65">7.4. 运行时间分析</a></li>
<li><a href="#orgdea690b">7.5. 使用 JavaScript</a>
<ul>
<li><a href="#org6ab4bc2">7.5.1. 创建 DOM</a></li>
<li><a href="#org0cc67ec">7.5.2. 执行 js 语句</a></li>
</ul>
</li>
<li><a href="#org03f8580">7.6. 动态组件 ipywidgets</a>
<ul>
<li><a href="#org507dc50">7.6.1. 安装</a></li>
<li><a href="#org9ff2a58">7.6.2. 基本动态组件 - 使用 interact</a></li>
</ul>
</li>
<li><a href="#org055998b">7.7. 自动重加载库</a></li>
<li><a href="#org3838c8c">7.8. nbdime：diff 工具</a>
<ul>
<li><a href="#org77c0484">7.8.1. 安装</a></li>
<li><a href="#org9ca4ff7">7.8.2. 基本使用</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org34e7237">8. cython</a>
<ul>
<li><a href="#orgef01551">8.1. 编译</a></li>
<li><a href="#org41fc406">8.2. 与 numpy 的结合</a>
<ul>
<li><a href="#orga60bb11">8.2.1. 配置</a></li>
<li><a href="#orge0be5aa">8.2.2. 类型</a></li>
<li><a href="#org98eda42">8.2.3. 获得指针</a></li>
</ul>
</li>
<li><a href="#orgb67ae94">8.3. 向外部 c 函数传递数组</a>
<ul>
<li><a href="#org04485db">8.3.1. h 文件中的声明</a></li>
<li><a href="#orgb9dc29f">8.3.2. pxd 文件中的声明</a></li>
<li><a href="#org24d945d">8.3.3. pyx 中的用法</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org80dab03">9. pillow: 图像处理</a></li>
<li><a href="#org7ac60fd">10. opencv: 图像处理</a>
<ul>
<li><a href="#orgeb037e3">10.1. 对图片进行切边操作</a></li>
</ul>
</li>
<li><a href="#org6b0807c">11. ctypes: c 互操作标准库</a></li>
<li><a href="#org5a767c3">12. cffi: c/c++ 互操作</a>
<ul>
<li><a href="#orgc0fc5df">12.1. 基本使用</a>
<ul>
<li><a href="#org27eb6a7">12.1.1. 内联调用方式</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org30946f0">13. pytesseract: OCR 识别库</a></li>
<li><a href="#org3d1ab48">14. h5py: 储存数据</a>
<ul>
<li><a href="#orgc9400da">14.1. 存</a></li>
<li><a href="#org7124c51">14.2. 取</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org3576466" class="outline-2">
<h2 id="org3576466"><span class="section-number-2">1</span> numpy</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org96f1542" class="outline-3">
<h3 id="org96f1542"><span class="section-number-3">1.1</span> 启用 MKL 支持</h3>
<div class="outline-text-3" id="text-1-1">
<p>
修改配置文件 <code>site.cfg</code>
</p>

<p>
然后
</p>
<div class="org-src-container">
<pre class="src src-bash">python setup.py build -j 4 install --prefix $HOME/.local
</pre>
</div>
</div>

<div id="outline-container-org873bd84" class="outline-4">
<h4 id="org873bd84"><span class="section-number-4">1.1.1</span> 编译安装OpenBLAS</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
<a href="https://github.com/xianyi/OpenBLAS">https://github.com/xianyi/OpenBLAS</a>
</p>
<div class="org-src-container">
<pre class="src src-bash">make FC=gfortran
make PREFIX=/opt/OpenBLAS install
</pre>
</div>
<p>
添加环境路径
</p>
<div class="org-src-container">
<pre class="src src-bash">export LD_LIBRARY_PATH=/opt/OpenBLAS/lib:$LD_LIBRARY_PATH
export C_INCLUDE_PATH=/opt/OpenBLAS/include:$C_INCLUDE_PATH 
export CPLUS_INCLUDE_PATH=/opt/OpenBLAS/include:$CPLUS_INCLUDE_PATH 
</pre>
</div>
</div>
</div>

<div id="outline-container-orga530571" class="outline-4">
<h4 id="orga530571"><span class="section-number-4">1.1.2</span> 编译安装numpy</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
修改设置文件
</p>
<div class="org-src-container">
<pre class="src src-bash">cp site.cfg.example site.cfg

[openblas]
libraries = openblas
library_dirs = /opt/OpenBLAS/lib
include_dirs = /opt/OpenBLAS/include
...
</pre>
</div>
<p>
编译安装
</p>
<div class="org-src-container">
<pre class="src src-bash">python3 setup.py install --user
</pre>
</div>
</div>
</div>
</div>
</div>


<div id="outline-container-org2ef36fe" class="outline-2">
<h2 id="org2ef36fe"><span class="section-number-2">2</span> scipy</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org6e71128" class="outline-3">
<h3 id="org6e71128"><span class="section-number-3">2.1</span> Scipy 的库</h3>
<div class="outline-text-3" id="text-2-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>Subpackage</code></td>
<td class="org-left">Description</td>
</tr>

<tr>
<td class="org-left"><code>cluster</code></td>
<td class="org-left">聚类算法Clustering algorithms</td>
</tr>

<tr>
<td class="org-left"><code>constants</code></td>
<td class="org-left">物理和数学常数Physical and mathematical constants</td>
</tr>

<tr>
<td class="org-left"><code>fftpack</code></td>
<td class="org-left">快速傅立叶变换Fast Fourier Transform routines</td>
</tr>

<tr>
<td class="org-left"><code>integrate</code></td>
<td class="org-left">积分和常微分方程解Integration and ordinary differential equation solvers</td>
</tr>

<tr>
<td class="org-left"><code>interpolate</code></td>
<td class="org-left">插值和光滑样条Interpolation and smoothing splines</td>
</tr>

<tr>
<td class="org-left"><code>io</code></td>
<td class="org-left">输入输出Input and Output</td>
</tr>

<tr>
<td class="org-left"><code>linalg</code></td>
<td class="org-left">线性代数Linear algebra</td>
</tr>

<tr>
<td class="org-left"><code>ndimage</code></td>
<td class="org-left">n维图像处理N-dimensional image processing</td>
</tr>

<tr>
<td class="org-left"><code>odr</code></td>
<td class="org-left">正交距离回归Orthogonal distance regression</td>
</tr>

<tr>
<td class="org-left"><code>optimize</code></td>
<td class="org-left">优化和寻根Optimization and root-finding routines</td>
</tr>

<tr>
<td class="org-left"><code>signal</code></td>
<td class="org-left">信号处理Signal processing</td>
</tr>

<tr>
<td class="org-left"><code>sparse</code></td>
<td class="org-left">稀疏矩阵和相关Sparse matrices and associated routines</td>
</tr>

<tr>
<td class="org-left"><code>spatial</code></td>
<td class="org-left">空间数据结构和算法Spatial data structures and algorithms</td>
</tr>

<tr>
<td class="org-left"><code>special</code></td>
<td class="org-left">特殊函数Special functions</td>
</tr>

<tr>
<td class="org-left"><code>stats</code></td>
<td class="org-left">统计分布和函数Statistical distributions and functions</td>
</tr>

<tr>
<td class="org-left"><code>weave</code></td>
<td class="org-left">c/c++集成C/C++ integration</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org01bc2e1" class="outline-3">
<h3 id="org01bc2e1"><span class="section-number-3">2.2</span> scipy.sparse 稀疏矩阵</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-orga4d7647" class="outline-4">
<h4 id="orga4d7647"><span class="section-number-4">2.2.1</span> 稀疏矩阵格式</h4>
<div class="outline-text-4" id="text-2-2-1">
<ul class="org-ul">
<li>coo格式用于构造和存储矩阵，矩阵构造或读取之后转换为 csr 或 csc 格式进行操作。</li>
<li>csr、csc格式用作矩阵运算</li>
<li>lil格式可以按列添加</li>
<li>dia格式用来储存对角元多的矩阵</li>
</ul>
</div>
</div>
</div>
</div>


<div id="outline-container-org70990f7" class="outline-2">
<h2 id="org70990f7"><span class="section-number-2">3</span> pandas</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org6efd920" class="outline-3">
<h3 id="org6efd920"><span class="section-number-3">3.1</span> 数据表格和矩阵之间的转换</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org7741dc2" class="outline-4">
<h4 id="org7741dc2"><span class="section-number-4">3.1.1</span> 从点的坐标表格 <code>(x,y,z)</code> 得到矩阵</h4>
<div class="outline-text-4" id="text-3-1-1">
<div class="org-src-container">
<pre class="src src-python">data = pd.DataFrame({"x": [1,1,2,2], "y":[3,4,3,4],"z":[9,8,7,6]})
data_2x2 = data.pivot(index="x",columns="y", values="z")

matrix = data_2x2.to_numpy()
</pre>
</div>
</div>
</div>

<div id="outline-container-org1ce6f6b" class="outline-4">
<h4 id="org1ce6f6b"><span class="section-number-4">3.1.2</span> 从矩阵表格得到坐标表格</h4>
<div class="outline-text-4" id="text-3-1-2">
<div class="org-src-container">
<pre class="src src-python">data = pd.DataFrame({"x": [1,1,2,2], "y":[3,4,3,4],"z":[9,8,7,6]})
data_2x2 = data.pivot(index="x",columns="y", values="z")

d = data_2x2.unstack().reset_index()
d.columns = ['y','x','z']
</pre>
</div>
</div>
</div>
</div>
</div>


<div id="outline-container-org565ab03" class="outline-2">
<h2 id="org565ab03"><span class="section-number-2">4</span> matplotlib</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org4436566" class="outline-3">
<h3 id="org4436566"><span class="section-number-3">4.1</span> 画多横线图</h3>
<div class="outline-text-3" id="text-4-1">
<p>
<a href="https://matplotlib.org/matplotblog/posts/create-ridgeplots-in-matplotlib/">https://matplotlib.org/matplotblog/posts/create-ridgeplots-in-matplotlib/</a>
</p>
<div class="org-src-container">
<pre class="src src-python">import matplotlib.gridspec as grid_spec

x = np.linspace(-5,5,30)
y = np.vstack([np.exp(-(x+a)**2) for a in np.linspace(0,3,8)])

gs = (grid_spec.GridSpec(len(d.index),1))

fig = plt.figure(figsize=(8,6))

ax_objs = []

for i in range(8):
    ax = fig.add_subplot(gs[i:i+1, 0:])
    ax_objs.append(ax)
    ax.plot(x, y[i,:])
    # ax.fill_between(x,y[i,:])


    # make background transparent
    rect = ax.patch
    rect.set_alpha(0)


    # remove borders, axis ticks, and labels
    ax.set_yticklabels([])
    ax.set_xticklabels([])
    ax.set_ylabel('')

    spines = ["top","right","left","bottom"]
    for s in spines:
	ax.spines[s].set_visible(False)


gs.update(hspace= -0.7)
# fig.tight_layout()
</pre>
</div>
</div>
</div>

<div id="outline-container-org30b8cda" class="outline-3">
<h3 id="org30b8cda"><span class="section-number-3">4.2</span> 画 3D 曲面图</h3>
<div class="outline-text-3" id="text-4-2">
<div class="org-src-container">
<pre class="src src-python">import matplotlib.pyplot as plt
from matplotlib import cm
xl = np.linspace(0,1,10)
yl = np.linspace(0,1,10)
X, Y = np.meshgrid(xl, yl)
Z = np.cos(X) + np.sin(Y)

fig = plt.figure()
ax = fig.gca(projection='3d')
surf = ax.plot_surface(X, Y, Z, cmap=cm.coolwarm,
		       linewidth=0, antialiased=False)
</pre>
</div>
</div>
</div>

<div id="outline-container-org3434daf" class="outline-3">
<h3 id="org3434daf"><span class="section-number-3">4.3</span> 画 3D 箭头场图</h3>
<div class="outline-text-3" id="text-4-3">
<div class="org-src-container">
<pre class="src src-python">from mpl_toolkits.mplot3d import axes3d
import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure()
ax = fig.gca(projection='3d')

x, y, z = np.meshgrid(np.arange(-0.8, 1, 0.2),
		      np.arange(-0.8, 1, 0.2),
		      np.arange(-0.8, 1, 0.8))

u = np.sin(np.pi * x) * np.cos(np.pi * y) * np.cos(np.pi * z)
v = -np.cos(np.pi * x) * np.sin(np.pi * y) * np.cos(np.pi * z)
w = (np.sqrt(2.0 / 3.0) * np.cos(np.pi * x) * np.cos(np.pi * y) *
     np.sin(np.pi * z))

ax.quiver(x, y, z, u, v, w, length=0.1)

plt.show()
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc860c8b" class="outline-3">
<h3 id="orgc860c8b"><span class="section-number-3">4.4</span> matplotlib使用中文与latex</h3>
<div class="outline-text-3" id="text-4-4">
</div>
<div id="outline-container-orgf0db9cb" class="outline-4">
<h4 id="orgf0db9cb"><span class="section-number-4">4.4.1</span> 图片中的文本使用latex符号</h4>
<div class="outline-text-4" id="text-4-4-1">
<div class="org-src-container">
<pre class="src src-python">from matplotlib import rc
rc('text',usetex=True)

</pre>
</div>
</div>
</div>

<div id="outline-container-orgdf727e5" class="outline-4">
<h4 id="orgdf727e5"><span class="section-number-4">4.4.2</span> 中文显示</h4>
<div class="outline-text-4" id="text-4-4-2">
<p>
关键在于自己指定字体
</p>

<div class="org-src-container">
<pre class="src src-python">plt.rcParams['font.sans-serif']=['SimHei'] #用来正常显示中文标签
plt.rcParams['axes.unicode_minus']=False #用来正常显示负号
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdfa4811" class="outline-4">
<h4 id="orgdfa4811"><span class="section-number-4">4.4.3</span> 图注和标签中的数学字体</h4>
<div class="outline-text-4" id="text-4-4-3">
<div class="org-src-container">
<pre class="src src-python">plt.rcdefaults()
plt.rcParams['mathtext.it']='sans:italic'
plt.rcParams['mathtext.fontset']='custom'
plt.rcParams['font.family']='Times New Roman'
plt.rcParams['font.style']='normal'
plt.rcParams['font.sans-serif']=['DejaVu Serif']
plt.rcParams['font.size']=14
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org54f665b" class="outline-3">
<h3 id="org54f665b"><span class="section-number-3">4.5</span> Legend中指定线和图例相对应的方法</h3>
<div class="outline-text-3" id="text-4-5">
<p>
在plot时的返回参数是两个,所以加逗号忽略第二个参数,用第一个来加图例才行
</p>
<div class="org-src-container">
<pre class="src src-python">a, = plt.plot(x,y)
plt.legend([a],["a"])
</pre>
</div>
</div>
</div>

<div id="outline-container-org2d08fb4" class="outline-3">
<h3 id="org2d08fb4"><span class="section-number-3">4.6</span> 并行化画图时,解决爆内存和同一图中画了好多线的方法</h3>
<div class="outline-text-3" id="text-4-6">
<ol class="org-ol">
<li>利用随机数做画图编号</li>
<li>画完图要关闭这个图</li>
</ol>

<div class="org-src-container">
<pre class="src src-python">from random import randint
fig_num = randint(0,10**10)
fig = plt.figure(fig_num)
cop, = plt.plot(tlist,na,label="$a^\\dagger a$")
z2p, = plt.plot(tlist,co,label="concurrence")
plt.legend([cop,z2p],["$a^\\dagger a$","concurrence"])
fig = plt.gcf()
fig.savefig('filename.png')
plt.close(fig_num)

</pre>
</div>
</div>
</div>

<div id="outline-container-orga4d2d9d" class="outline-3">
<h3 id="orga4d2d9d"><span class="section-number-3">4.7</span> 让画出来的图片连在一起动起来的方法</h3>
<div class="outline-text-3" id="text-4-7">
<p>
matplotlib本身并不能实现这个功能,可以采用的方法有ffmpeg, opencv, imagemagic等,这里选用最简单方便的imagemagic
</p>
<div class="org-src-container">
<pre class="src src-bash">convert -delay 10 -loop 0 a1.png a2.png a.gif
</pre>
</div>
<p>
选项含义:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">选项</td>
<td class="org-left">意义</td>
</tr>

<tr>
<td class="org-left"><code>-delay 10</code></td>
<td class="org-left">每张图片延时</td>
</tr>

<tr>
<td class="org-left"><code>-loop 0</code></td>
<td class="org-left">循环播放次数,0为一直循环</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgc6bad17" class="outline-3">
<h3 id="orgc6bad17"><span class="section-number-3">4.8</span> 保存图片时超出的部分存不上</h3>
<div class="outline-text-3" id="text-4-8">
<div class="org-src-container">
<pre class="src src-python">plt.tight_layout(pad=0,rect=(0,0,1,1)) # 设置保存图片的边缘大小
plt.savefig("fig")
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc72800a" class="outline-3">
<h3 id="orgc72800a"><span class="section-number-3">4.9</span> 保存图片时没有 <code>suptitle</code> 部分</h3>
<div class="outline-text-3" id="text-4-9">
<p>
在 <code>savefig</code> 时加上它，参见 <a href="https://stackoverflow.com/questions/33414819/matplotlib-doesnt-save-suptitle">Matplotlib doesn't save suptitle</a>
</p>

<div class="org-src-container">
<pre class="src src-python">true_vals = [1,2,3]

f, ax_arr = plt.subplots(1,3,figsize=(15,5))
ax_arr = ax_arr.reshape(-1)
my_suptitle = f.suptitle("This is my suptitle\nThis is the second line", fontsize=20, y=1.1) 
# y is set to 1.1 to keep the second line in the suptitle from hitting the top of the subplots.

for idx, i in enumerate(true_vals):
    ax_arr[idx].boxplot(data[:,idx], labels=i)

f.savefig('suptitle_test.pdf', dpi=f.dpi, bbox_inches='tight',bbox_extra_artists=[my_suptitle])
</pre>
</div>
</div>
</div>

<div id="outline-container-orge3bdadf" class="outline-3">
<h3 id="orge3bdadf"><span class="section-number-3">4.10</span> 设置默认绘图样式</h3>
<div class="outline-text-3" id="text-4-10">
</div>
<div id="outline-container-orge1353f5" class="outline-4">
<h4 id="orge1353f5"><span class="section-number-4">4.10.1</span> 设置全局样式</h4>
<div class="outline-text-4" id="text-4-10-1">
<p>
用 <code>matplotlib.get_configdir()</code> 查看设置文件路径, 一般可能是 <code>$HOME/.config/matplotlib</code>
在这个路径新建文件 <code>matplotlibrc</code> 在这里设置, 相见 <a href="https://matplotlib.org/tutorials/introductory/customizing.html#customizing-with-matplotlibrc-files">文档</a>
下面的内容会设置字体和大小
</p>
<pre class="example">
mathtext.it :sans:italic
mathtext.fontset :custom
font.family :Times New Roman
font.style :normal
font.sans-serif :Liberation Serif
font.size :12
</pre>
</div>
</div>

<div id="outline-container-org5da83d8" class="outline-4">
<h4 id="org5da83d8"><span class="section-number-4">4.10.2</span> 设置和使用局部样式</h4>
<div class="outline-text-4" id="text-4-10-2">
<p>
在设置路径中新建文件夹 <code>$HOME/.config/matplotlib/stylelib</code> 
并在这个文件夹中新建样式文件 <code>name.mplstyle</code>
内容规则同全局样式.
使用方法:
</p>
<ol class="org-ol">
<li>局部使用</li>
</ol>
<div class="org-src-container">
<pre class="src src-python">with plt.style.context(['dark_background']):
    plt.plot(x,y)
    plt.show()
</pre>
</div>
<ol class="org-ol">
<li>全局使用</li>
</ol>
<div class="org-src-container">
<pre class="src src-python">plt.style.use(['style1','style2'])
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2974341" class="outline-3">
<h3 id="org2974341"><span class="section-number-3">4.11</span> 在 JupyterLab 里让图动起来</h3>
<div class="outline-text-3" id="text-4-11">
<p>
见 <a href="https://github.com/matplotlib/ipympl">https://github.com/matplotlib/ipympl</a>
要安装 
</p>
<div class="org-src-container">
<pre class="src src-bash">pip install ipympl

jupyter labextension install @jupyter-widgets/jupyterlab-manager jupyter-matplotlib
</pre>
</div>

<p>
然后在每次画图前写上 
</p>
<div class="org-src-container">
<pre class="src src-python">%matplotlib widget
</pre>
</div>
</div>
</div>

<div id="outline-container-org4a49653" class="outline-3">
<h3 id="org4a49653"><span class="section-number-3">4.12</span> 论文图片样式</h3>
<div class="outline-text-3" id="text-4-12">
</div>
<div id="outline-container-orgeeb483a" class="outline-4">
<h4 id="orgeeb483a"><span class="section-number-4">4.12.1</span> 设置方式</h4>
<div class="outline-text-4" id="text-4-12-1">
<p>
将样式文件保存在设置目录中，例如 <code>.config/matplotlib/stylelib</code> , 文件以 <code>.mplstyle</code> 为后缀。
更多样式修改方式见<a href="https://github.com/matplotlib/matplotlib/blob/v3.3.2/matplotlibrc.template">matplotlib/matplotlibrc.template</a> 。
使用方式如下
</p>
<div class="org-src-container">
<pre class="src src-python">import matplotlib
matplotlib.style.reload_library()
matplotlib.style.use(['paper', 'paper_onecol'])
</pre>
</div>
</div>
</div>

<div id="outline-container-org3d4ae9d" class="outline-4">
<h4 id="org3d4ae9d"><span class="section-number-4">4.12.2</span> 通用样式 <code>paper.mplstyle</code></h4>
<div class="outline-text-4" id="text-4-12-2">
<pre class="example">
axes.titlesize  : 20
axes.labelsize  : 20
xtick.labelsize : 16
ytick.labelsize : 16
text.usetex     : true
font.family     : Times New Roman
font.serif      : Latin Modern Math
legend.title_fontsize: 16
legend.fontsize : 16
</pre>
</div>
</div>

<div id="outline-container-orgce939a2" class="outline-4">
<h4 id="orgce939a2"><span class="section-number-4">4.12.3</span> 单栏样式 <code>paper_onecol.mplstyle</code></h4>
<div class="outline-text-4" id="text-4-12-3">
<pre class="example">
figure.figsize: 7, 4.3262379212492634
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge98542d" class="outline-2">
<h2 id="orge98542d"><span class="section-number-2">5</span> seaborn</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org577843c" class="outline-3">
<h3 id="org577843c"><span class="section-number-3">5.1</span> 设置样式</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">
<pre class="src src-python">import seaborn as sns
sns.set()
sns.set_palette('muted',8)
sns.set_style("whitegrid")
sns.set_context("notebook")
</pre>
</div>

<p>
其中 <code>set_palette</code> 为<a href="https://seaborn.pydata.org/tutorial/color_palettes.html">设置色盘</a>；
<code>set_style</code> 为 <a href="https://seaborn.pydata.org/generated/seaborn.set_style.html">设置样式</a>，有无网格线等等；
<code>set_context</code> 为 <a href="https://seaborn.pydata.org/generated/seaborn.set_context.html">设置环境</a>，即字号大小等。
</p>
</div>
</div>

<div id="outline-container-orge603db8" class="outline-3">
<h3 id="orge603db8"><span class="section-number-3">5.2</span> lineplot</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">
<pre class="src src-python">data = pd.DataFrame({"x": [1, 2, 3], "y": [3, 4, 5], "z": [6, 7, 8]})
ax = sns.lineplot(x="x",
		  y="y",
		  data=data,
		  hue="z",
		  palette="pastel",
		  legend="full")
ax.set_xlabel(r"$x$")
ax.set_ylabel(r"$y$")
ax.set_title("x-y for z")
handles, labels = ax.get_legend_handles_labels()
ax.legend(handles=handles[1:], labels=labels[1:], title="z")
</pre>
</div>
</div>
</div>

<div id="outline-container-org7d7f94c" class="outline-3">
<h3 id="org7d7f94c"><span class="section-number-3">5.3</span> heatmap</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-src-container">
<pre class="src src-python">data = pd.DataFrame({"x": [1, 2, 3], "y": [3, 4, 5], "z": [6, 7, 8]})
d = data.pivot(index="x", columns="y", values="z")
ax = sns.heatmap(d)
ax.invert_yaxis()
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org559cc1b" class="outline-2">
<h2 id="org559cc1b"><span class="section-number-2">6</span> bokeh</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org919eb83" class="outline-3">
<h3 id="org919eb83"><span class="section-number-3">6.1</span> 基本示例</h3>
<div class="outline-text-3" id="text-6-1">
<div class="org-src-container">
<pre class="src src-python"># 导入
from bokeh.plotting import figure,show,output_notebook
output_notebook()

# 计算
import numpy as np
x = np.linspace(0,10,100)
y = np.exp(x)

# 画图
p = figure(x_axis_label="x", y_axis_label="y",y_axis_type="log",title="title")
p.line(x=x,y=y,legend_label="line")
show(p)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgc6655aa" class="outline-2">
<h2 id="orgc6655aa"><span class="section-number-2">7</span> jupyter</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-orge492349" class="outline-3">
<h3 id="orge492349"><span class="section-number-3">7.1</span> 常用模板</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">
<pre class="src src-python">import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from ipywidgets import interact, widgets
from bokeh.plotting import figure,show,output_notebook
from tqdm import tqdm
sns.set()
sns.set_palette('muted')
sns.set_style("whitegrid")
sns.set_context("notebook")
np.set_printoptions(suppress=True, precision=4)
output_notebook()
%load_ext autoreload
%autoreload 2
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc9895de" class="outline-3">
<h3 id="orgc9895de"><span class="section-number-3">7.2</span> 有用的插件</h3>
<div class="outline-text-3" id="text-7-2">
<ol class="org-ol">
<li><a href="https://github.com/jupyterlab/jupyterlab-toc">@jupyterlab/toc</a> : 目录，必备</li>
<li><a href="https://github.com/ryantam626/jupyterlab_code_formatter">jupyterlab<sub>code</sub><sub>formatter</sub></a> : 格式化代码，必备</li>
<li><a href="https://github.com/jupyterlab/jupyter-renderers">@jupyterlab/katex-extension</a> : 使用 katex 渲染数学公式，速度能稍微快一点</li>
<li><a href="https://github.com/jupyterlab/jupyterlab-git">@jupyterlab/git</a> : 在网页上方便的使用git，还是要习惯用这个做后悔药</li>
<li><a href="https://github.com/jupyter/nbdime">nbdime</a> : 用来比较ipynb的不同处，git必备</li>
<li><a href="https://github.com/mwouts/jupytext">jupytext</a> : 同步ipynb文件和对应的py文件，某些情况下有用</li>
</ol>
</div>
</div>

<div id="outline-container-orgfe68c84" class="outline-3">
<h3 id="orgfe68c84"><span class="section-number-3">7.3</span> 在jupyter中使用ipdb</h3>
<div class="outline-text-3" id="text-7-3">
<ol class="org-ol">
<li>在某位置设断点的方法</li>
</ol>
<div class="org-src-container">
<pre class="src src-python">from IPython.core.debugger import Tracer
Tracer()()#断点
</pre>
</div>
<ol class="org-ol">
<li>出错自动进入ipdb模式</li>
</ol>
<div class="org-src-container">
<pre class="src src-python">%pdb
</pre>
</div>
</div>
</div>

<div id="outline-container-orgec8ea65" class="outline-3">
<h3 id="orgec8ea65"><span class="section-number-3">7.4</span> 运行时间分析</h3>
<div class="outline-text-3" id="text-7-4">
<p>
得到执行单个cell用时,在开始处添加 <code>%%time</code>
</p>
</div>
</div>

<div id="outline-container-orgdea690b" class="outline-3">
<h3 id="orgdea690b"><span class="section-number-3">7.5</span> 使用 JavaScript</h3>
<div class="outline-text-3" id="text-7-5">
</div>
<div id="outline-container-org6ab4bc2" class="outline-4">
<h4 id="org6ab4bc2"><span class="section-number-4">7.5.1</span> 创建 DOM</h4>
<div class="outline-text-4" id="text-7-5-1">
<div class="org-src-container">
<pre class="src src-python">import ipywidgets
ipywidgets.HTML('''&lt;div id="echarts" style="width: 600px;height:400px;"&gt;&lt;/div&gt;''')
</pre>
</div>
</div>
</div>

<div id="outline-container-org0cc67ec" class="outline-4">
<h4 id="org0cc67ec"><span class="section-number-4">7.5.2</span> 执行 js 语句</h4>
<div class="outline-text-4" id="text-7-5-2">
</div>
<ol class="org-ol">
<li><a id="org9978af2"></a>使用魔术指令<br />
<div class="outline-text-5" id="text-7-5-2-1">
<div class="org-src-container">
<pre class="src src-javascript">    %%javascript
var s = document.createElement('script');
s.src = "https://cdn.bootcss.com/echarts/4.2.0-rc.2/echarts.min.js";
document.getElementsByTagName("head")[0].appendChild(s);
var myChart = echarts.init(document.getElementById('echarts'));

var option = {
    title: {
	text: 'ECharts 入门示例'
    },
    tooltip: {},
    legend: {
	data:['销量']
    },
    xAxis: {
	data: ["衬衫","羊毛衫","雪纺衫","裤子","高跟鞋","袜子"]
    },
    yAxis: {},
    series: [{
	name: '销量',
	type: 'bar',
	data: [5, 20, 36, 10, 10, 20]
    }]
};

myChart.setOption(option);
</pre>
</div>
</div>
</li>

<li><a id="org2d42de4"></a>使用 python<br />
<div class="outline-text-5" id="text-7-5-2-2">
<div class="org-src-container">
<pre class="src src-python">from IPython.display import Javascript
Javascript('''
var s = document.createElement('script');
s.src = "https://cdn.bootcss.com/echarts/4.2.0-rc.2/echarts.min.js";
document.getElementsByTagName("head")[0].appendChild(s);
var myChart = echarts.init(document.getElementById('echarts'));

var option = {
    title: {
	text: 'ECharts 入门示例'
    },
    tooltip: {},
    legend: {
	data:['销量']
    },
    xAxis: {
	data: ["衬衫","羊毛衫","雪纺衫","裤子","高跟鞋","袜子"]
    },
    yAxis: {},
    series: [{
	name: '销量',
	type: 'bar',
	data: [5, 20, 36, 10, 10, 20]
    }]
};

myChart.setOption(option);
''')
</pre>
</div>
</div>
</li>

<li><a id="org5f06192"></a>从 CDN 加载 js 文件<br />
<div class="outline-text-5" id="text-7-5-2-3">
<p>
三个语句，哪个都不能缺
</p>
<div class="org-src-container">
<pre class="src src-js">var s = document.createElement('script');
s.src = "https://cdn.bootcss.com/echarts/4.2.0-rc.2/echarts.min.js";
document.getElementsByTagName("head")[0].appendChild(s);
</pre>
</div>
</div>
</li>

<li><a id="org62985c6"></a>通用方法<br />
<div class="outline-text-5" id="text-7-5-2-4">
<div class="org-src-container">
<pre class="src src-python">from IPython.display import Javascript
Javascript('''
var s = document.createElement('script');
s.src = "http://www.echartsjs.com/dist/echarts.js";
document.getElementsByTagName("head")[0].appendChild(s);
var s = document.createElement('script');
s.src = "http://www.echartsjs.com/dist/echarts-gl.js";
document.getElementsByTagName("head")[0].appendChild(s);''')


def javascript_text(text):
    text = ("""
    var s = document.createElement('script');
    s.text = `{}`;
    document.getElementsByTagName("head")[0].appendChild(s);
    """.format(text))
    return (text)


Javascript(javascript_text('alert("asd");'))
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org03f8580" class="outline-3">
<h3 id="org03f8580"><span class="section-number-3">7.6</span> 动态组件 ipywidgets</h3>
<div class="outline-text-3" id="text-7-6">
</div>
<div id="outline-container-org507dc50" class="outline-4">
<h4 id="org507dc50"><span class="section-number-4">7.6.1</span> 安装</h4>
<div class="outline-text-4" id="text-7-6-1">
<p>
对于 notebook
</p>
<pre class="example">
pip install ipywidgets
jupyter nbextension enable --py widgetsnbextension
</pre>

<p>
对于 lab
</p>
<div class="org-src-container">
<pre class="src src-bash">pip install ipywidgets
jupyter labextension install @jupyter-widgets/jupyterlab-manager
</pre>
</div>
</div>
</div>

<div id="outline-container-org9ff2a58" class="outline-4">
<h4 id="org9ff2a58"><span class="section-number-4">7.6.2</span> 基本动态组件 - 使用 interact</h4>
<div class="outline-text-4" id="text-7-6-2">
<div class="org-src-container">
<pre class="src src-python">from ipywidgets import interact, widgets

def f(x):
    return x+100

interact(f, x=10)
</pre>
</div>

<p>
或者定制组件范围
</p>
<div class="org-src-container">
<pre class="src src-python">interact(f, x=widgets.FloatSlider(min=0,max=100,description="asd:"))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org055998b" class="outline-3">
<h3 id="org055998b"><span class="section-number-3">7.7</span> 自动重加载库</h3>
<div class="outline-text-3" id="text-7-7">
<div class="org-src-container">
<pre class="src src-python">%load_ext autoreload 
%autoreload 2
</pre>
</div>
</div>
</div>

<div id="outline-container-org3838c8c" class="outline-3">
<h3 id="org3838c8c"><span class="section-number-3">7.8</span> nbdime：diff 工具</h3>
<div class="outline-text-3" id="text-7-8">
</div>
<div id="outline-container-org77c0484" class="outline-4">
<h4 id="org77c0484"><span class="section-number-4">7.8.1</span> 安装</h4>
<div class="outline-text-4" id="text-7-8-1">
<ol class="org-ol">
<li>安装 <code>pip install nbdime</code></li>
<li>启用 git <code>nbdime config-git --enable --global</code></li>
</ol>
</div>
</div>

<div id="outline-container-org9ca4ff7" class="outline-4">
<h4 id="org9ca4ff7"><span class="section-number-4">7.8.2</span> 基本使用</h4>
<div class="outline-text-4" id="text-7-8-2">
<ol class="org-ol">
<li>比较 <code>nbdiff notebook_1.ipynb notebook_2.ipynb</code></li>
<li>网页端显示比较 <code>nbdiff-web notebook_1.ipynb notebook_2.ipynb</code></li>
</ol>
</div>
</div>
</div>
</div>


<div id="outline-container-org34e7237" class="outline-2">
<h2 id="org34e7237"><span class="section-number-2">8</span> cython</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-orgef01551" class="outline-3">
<h3 id="orgef01551"><span class="section-number-3">8.1</span> 编译</h3>
<div class="outline-text-3" id="text-8-1">
<p>
<code>setup.py</code> 文件， <code>python3 setup.py build_ext -i</code>
</p>
<div class="org-src-container">
<pre class="src src-python">from distutils.core import setup
from distutils.extension import Extension
from Cython.Build import cythonize
import numpy

setup(ext_modules=cythonize([
    Extension("f", ["f.pyx"],
	      libraries=["f"],
	      runtime_library_dirs=["."],
	      include_dirs=[numpy.get_include()],
	      library_dirs=["."])
],
			    language_level=3))
</pre>
</div>
</div>
</div>

<div id="outline-container-org41fc406" class="outline-3">
<h3 id="org41fc406"><span class="section-number-3">8.2</span> 与 numpy 的结合</h3>
<div class="outline-text-3" id="text-8-2">
</div>
<div id="outline-container-orga60bb11" class="outline-4">
<h4 id="orga60bb11"><span class="section-number-4">8.2.1</span> 配置</h4>
<div class="outline-text-4" id="text-8-2-1">
<ol class="org-ol">
<li><code>setup.py</code> 里必须设置 <code>include_dirs</code></li>
</ol>
<div class="org-src-container">
<pre class="src src-python">import numpy as np
cimport numpy as np

</pre>
</div>
</div>
</div>

<div id="outline-container-orge0be5aa" class="outline-4">
<h4 id="orge0be5aa"><span class="section-number-4">8.2.2</span> 类型</h4>
<div class="outline-text-4" id="text-8-2-2">
<ol class="org-ol">
<li>数值类型运行时类型带 t， 一般类型不带 t</li>
<li>数组类型 <code>np.ndarray[np.float_t,ndim=1,mode="c"]</code></li>
</ol>

<div class="org-src-container">
<pre class="src src-python">ctypedef np.float_t FLOAT_t
FLOAT = np.float

cpdef np.ndarray[FLOAT_t,ndim=1,mode="c"] l():
cdef np.ndarray[FLOAT_t,ndim=1,mode="c"] z
z = np.array([0],dtype=FLOAT)
    return z
</pre>
</div>
</div>
</div>

<div id="outline-container-org98eda42" class="outline-4">
<h4 id="org98eda42"><span class="section-number-4">8.2.3</span> 获得指针</h4>
<div class="outline-text-4" id="text-8-2-3">
<ol class="org-ol">
<li><p>
声明指针
</p>
<div class="org-src-container">
<pre class="src src-python">cdef double[::1] z_memview = z
</pre>
</div></li>
<li><p>
向函数传递指针
</p>
<div class="org-src-container">
<pre class="src src-python">cf.l(&amp;z_memview[0])
</pre>
</div></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgb67ae94" class="outline-3">
<h3 id="orgb67ae94"><span class="section-number-3">8.3</span> 向外部 c 函数传递数组</h3>
<div class="outline-text-3" id="text-8-3">
</div>
<div id="outline-container-org04485db" class="outline-4">
<h4 id="org04485db"><span class="section-number-4">8.3.1</span> h 文件中的声明</h4>
<div class="outline-text-4" id="text-8-3-1">
<p>
声明的是数组
</p>
<div class="org-src-container">
<pre class="src src-python">void f(double result[]);
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb9dc29f" class="outline-4">
<h4 id="orgb9dc29f"><span class="section-number-4">8.3.2</span> pxd 文件中的声明</h4>
<div class="outline-text-4" id="text-8-3-2">
<p>
声明的是指针
</p>
<div class="org-src-container">
<pre class="src src-python">void f(double* result)
</pre>
</div>
</div>
</div>

<div id="outline-container-org24d945d" class="outline-4">
<h4 id="org24d945d"><span class="section-number-4">8.3.3</span> pyx 中的用法</h4>
<div class="outline-text-4" id="text-8-3-3">
<p>
传递的是指针
</p>
<div class="org-src-container">
<pre class="src src-python">cdef double[::1] z_memview = z
cf.l(&amp;z_memview[0])
</pre>
</div>
</div>
</div>
</div>
</div>


<div id="outline-container-org80dab03" class="outline-2">
<h2 id="org80dab03"><span class="section-number-2">9</span> pillow: 图像处理</h2>
</div>


<div id="outline-container-org7ac60fd" class="outline-2">
<h2 id="org7ac60fd"><span class="section-number-2">10</span> opencv: 图像处理</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-orgeb037e3" class="outline-3">
<h3 id="orgeb037e3"><span class="section-number-3">10.1</span> 对图片进行切边操作</h3>
<div class="outline-text-3" id="text-10-1">
<div class="org-src-container">
<pre class="src src-python">import matplotlib.pyplot as plt
import cv2
import numpy as np

text = r"\frac{1}{2}"
file_name = "fi.png"

# make math text
plt.figure(figsize=(5, 5), dpi=300)
plt.axis('off')
plt.text(
    0, 0, text.replace(r'\[', r'$').replace(r'\]', r'$'), ha='left', wrap=True)
plt.savefig(file_name, bbox_inches='tight', transparent=True)

# cut white side
img = cv2.imread(file_name)
img2gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
indexes = np.argwhere(img2gray &lt; 255)
x_min = min(indexes[:, 0])
x_max = max(indexes[:, 0])
y_min = min(indexes[:, 1])
y_max = max(indexes[:, 1])
img_new = img[x_min:x_max, y_min:y_max]
cv2.imwrite(file_name, img_new)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org6b0807c" class="outline-2">
<h2 id="org6b0807c"><span class="section-number-2">11</span> ctypes: c 互操作标准库</h2>
<div class="outline-text-2" id="text-11">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>import ctypes</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>asd=ctypes.CDLL("a.so")</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left"><code>asd.haha(2)</code></td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>



<div id="outline-container-org5a767c3" class="outline-2">
<h2 id="org5a767c3"><span class="section-number-2">12</span> cffi: c/c++ 互操作</h2>
<div class="outline-text-2" id="text-12">
<p>
cffi 是用来直接包裹 c 函数的库，与 ctypes 功能相同，不能将 python 编译成 c，即与 cython 不同
</p>
</div>
<div id="outline-container-orgc0fc5df" class="outline-3">
<h3 id="orgc0fc5df"><span class="section-number-3">12.1</span> 基本使用</h3>
<div class="outline-text-3" id="text-12-1">
</div>
<div id="outline-container-org27eb6a7" class="outline-4">
<h4 id="org27eb6a7"><span class="section-number-4">12.1.1</span> 内联调用方式</h4>
<div class="outline-text-4" id="text-12-1-1">
<div class="org-src-container">
<pre class="src src-python">import cffi

 ffi = cffi.FFI()
 ffi.cdef("""void f(double result[],double a_r, double a_i, double b_r, double b_i, double t,
	double Delta, double omega, double c_var, double A,
	double epsilon_0);         
	""")
 lib = ffi.dlopen("./libf.so")

 def cf(t,y,Delta,omega,c,A,epslion_0):
     tt = ffi.new("double[4]")
     lib.f(tt,y[0],y[1],y[2],y[3],t,Delta,omega,c,A,epslion_0)
     return list(tt)
</pre>
</div>
</div>
</div>
</div>
</div>



<div id="outline-container-org30946f0" class="outline-2">
<h2 id="org30946f0"><span class="section-number-2">13</span> pytesseract: OCR 识别库</h2>
<div class="outline-text-2" id="text-13">
<ol class="org-ol">
<li>参见 <a href="https://github.com/madmaze/pytesseract">madmaze/pytesseract</a></li>
<li>首先要安装 tesseract</li>
</ol>

<p>
示例如下：
</p>
<div class="org-src-container">
<pre class="src src-python">import pytesseract
from PIL import Image
print(pytesseract.image_to_string(Image.open('a.png')))
</pre>
</div>
</div>
</div>



<div id="outline-container-org3d1ab48" class="outline-2">
<h2 id="org3d1ab48"><span class="section-number-2">14</span> h5py: 储存数据</h2>
<div class="outline-text-2" id="text-14">
</div>
<div id="outline-container-orgc9400da" class="outline-3">
<h3 id="orgc9400da"><span class="section-number-3">14.1</span> 存</h3>
<div class="outline-text-3" id="text-14-1">
<div class="org-src-container">
<pre class="src src-python">with h5py.File('data.h5', 'w') as hf:
    hf.create_dataset("mat1", data=mat1, compression="gzip")
    hf.create_dataset("mat2", data=mat2, compression="gzip")

    g = hf.create_group("index")
    g.create_dataset("mat1", data=mat1, compression="gzip")

</pre>
</div>
</div>
</div>


<div id="outline-container-org7124c51" class="outline-3">
<h3 id="org7124c51"><span class="section-number-3">14.2</span> 取</h3>
<div class="outline-text-3" id="text-14-2">
<div class="org-src-container">
<pre class="src src-python">with h5py.File('data.h5', 'r') as hf:
    mat1 = np.array(hf['mat1'])
    mat2 = np.array(hf['mat2'])

    g = hf['index']
    g_mat1 = np.array(g['mat1'])

</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: chimez</p>
<p class="date">Created: 2020-12-19 Sat 14:08</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
