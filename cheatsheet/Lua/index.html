<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Lua | Chimez</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Lua基本语法
    


    
        变量
        
        LUA_INIT=&quot;filename&quot;运行lua脚本时首先执行
arg[1]=&quot;a&quot;arg是存储命令行参数的table，参数从1开始，0,-1...为命令行其他内容
local a声明局部变量
local a=a用全局变量创建同名局部变量，可以加速块内访问速度">
<meta property="og:type" content="article">
<meta property="og:title" content="Lua">
<meta property="og:url" content="http://chimez.github.io/cheatsheet/Lua/index.html">
<meta property="og:site_name" content="Chimez">
<meta property="og:description" content="Lua基本语法
    


    
        变量
        
        LUA_INIT=&quot;filename&quot;运行lua脚本时首先执行
arg[1]=&quot;a&quot;arg是存储命令行参数的table，参数从1开始，0,-1...为命令行其他内容
local a声明局部变量
local a=a用全局变量创建同名局部变量，可以加速块内访问速度">
<meta property="og:updated_time" content="2017-02-03T03:44:07.541Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lua">
<meta name="twitter:description" content="Lua基本语法
    


    
        变量
        
        LUA_INIT=&quot;filename&quot;运行lua脚本时首先执行
arg[1]=&quot;a&quot;arg是存储命令行参数的table，参数从1开始，0,-1...为命令行其他内容
local a声明局部变量
local a=a用全局变量创建同名局部变量，可以加速块内访问速度">
  
    <link rel="alternate" href="/atom.xml" title="Chimez" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <h1 id="logo-wrap">
      <a href="/" id="logo">Chimez</a>
    </h1>
    
    <nav id="main-nav">
      <a id="main-nav-toggle" class="nav-icon"></a>
      
        <a class="main-nav-link" href="/">主页</a>
       
        <a class="main-nav-link" href="/categories/文章/">文章</a>
       
        <a class="main-nav-link" href="/categories/备忘卡/">备忘卡</a>
       
        <a class="main-nav-link" href="/categories/思维导图/">思维导图</a>
       
        <a class="main-nav-link" href="/categories/项目/">项目</a>
       
        <a class="main-nav-link" href="/archives">存档</a>
       
        <a class="main-nav-link" href="/about">关于</a>
       
    </nav>
    <!-- <nav id="sub-nav"> -->
    <!--    -->
    <!--     <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a> -->
    <!--     -->
    <!--   <a id="nav-search-btn" class="nav-icon" title="搜索"></a> -->
    <!-- </nav> -->
    <!-- <div id="search-form-wrap"> -->
    <!--   <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://chimez.github.io"></form> -->
    <!-- </div> -->
  </div>
</header>

      <div class="outer">
        <section id="main"><article>
  <link rel="stylesheet" href="/css/cheatsheet.css">
  <body>
    <header>
        <h1>Lua基本语法</h1>
    </header>

<section>
    <article>
        <h2>变量</h2>
        <dl>
        <dt><code>LUA_INIT="filename"</code></dt><dd>运行lua脚本时首先执行</dd>
<dt><code>arg[1]="a"</code></dt><dd>arg是存储命令行参数的table，参数从1开始，0,-1...为命令行其他内容</dd>
<dt><code>local a</code></dt><dd>声明局部变量</dd>
<dt><code>local a=a</code></dt><dd>用全局变量创建同名局部变量，可以加速块内访问速度</dd>

        </dl>
    </article>
</section>
<section>
    <article>
        <h2>类型</h2>
        <dl>
        <dt><code>nil</code></dt><dd>空</dd>
<dt><code>boolean</code></dt><dd>布尔,只有false和nil为假，true及其他都算真</dd>
<dt><code>number</code></dt><dd>数字，默认为32位双精度浮点数</dd>
<dt><code>string</code></dt><dd>字符串，不可变，支持任意二进制数据和任意大小</dd>
<dt><code>userdata</code></dt><dd>自定义类型</dd>
<dt><code>function</code></dt><dd>函数</dd>
<dt><code>thread</code></dt><dd>线程</dd>
<dt><code>table</code></dt><dd>表</dd>
<dt><code>4e+4,5e-1</code></dt><dd>支持科学计数法</dd>
<dt><code>\n</code></dt><dd>转义字符，换行</dd>
<dt><code>\r</code></dt><dd>转义字符，回车</dd>
<dt><code>\t</code></dt><dd>转义字符，tab</dd>
<dt><code>\\</code></dt><dd>转义字符，\</dd>
<dt><code>\'</code></dt><dd>转义字符,'</dd>
<dt><code>\"</code></dt><dd>转义字符,"</dd>
<dt><code>\<ddd></ddd></code></dt><dd>三个十进制数字，引用ASCLL</dd>
<dt><code>[[]],[===[ ]===]</code></dt><dd>0或任意数量等号界定的格式字符串，内部字符不会被解析</dd>

        </dl>
    </article>
</section>
<section>
    <article>
        <h2>Table数据结构</h2>
        <dl>
        <dt><code>不能显式声明table，可以通过构造表达式声明</code></dt><dd></dd>
<dt><code>table是永远匿名</code></dt><dd>删除其引用（指针）不会删除table</dd>
<dt><code>table默认从1开始计数</code></dt><dd></dd>
<dt><code>a={}</code></dt><dd>声明一个table，a</dd>
<dt><code>a[k]= 10    </code></dt><dd>a中的新条目，key=‘x'，value=10</dd>
<dt><code>a={'a','b','c'} </code></dt><dd>  a[1]='a'</dd>
<dt><code>a=(x=10,y=20}   </code></dt><dd>  a.x=10,a.y=20</dd>
<dt><code>a={[5+10]='a'}; a[15]='a'   </code></dt><dd>方括号内可以有显式表达式</dd>
<dt><code>a={1,2,3,}  </code></dt><dd>最后一个值可以加逗号</dd>
<dt><code>a.k == a[k]</code></dt><dd>table的引用</dd>
<dt><code>\#a </code></dt><dd>表示a的大小或最后一个元素的索引</dd>

        </dl>
    </article>
</section>
<section>
    <article>
        <h2>函数</h2>
        <dl>
        <dt><code>只有一个参数且是字符串或table可以不加括号</code></dt><dd></dd>
<dt><code>o.f(o,b) == o:f(b)</code></dt><dd>冒号操作符   </dd>
<dt><code>return a,b</code></dt><dd>支持多重返回值   </dd>
<dt><code>return f()</code></dt><dd>强制全部返回     </dd>
<dt><code>(f())</code></dt><dd>强制只返回第一个     </dd>
<dt><code>unpack()     </code></dt><dd>接受数组参数，并从1开始返回数组的元素</dd>
<dt><code>function f(...) end</code></dt><dd>函数定义，变长参数</dd>
<dt><code>function f(...) end</code></dt><dd>函数定义，变长参数</dd>
<dt><code>所有参数在数组‘...’里</code></dt><dd></dd>
<dt><code>不支持具名实参传入(a='a',b='b')</code></dt><dd>但是可以传入一个table,{a='a',b='b'}</dd>
<dt><code>所有函数都是匿名的</code></dt><dd>函数名只是函数指针</dd>
<dt><code>function (x) return x end</code></dt><dd>匿名函数    </dd>
<dt><code>支持高阶函数</code></dt><dd></dd>
<dt><code>closure闭合函数</code></dt><dd>函数加上非局部变量</dd>
<dt><code>return g()</code></dt><dd>尾调用作用消除， 相当于   goto g</dd>

        </dl>
    </article>
</section>
<section>
    <article>
        <h2>函数或操作符</h2>
        <dl>
        <dt><code>type()</code></dt><dd>返回目标类型，字符串</dd>
<dt><code>+，-，×，/，%，^</code></dt><dd>加减乘除取模指数，对字符串会进行强转成数字</dd>
<dt><code><,>,<=,>=,==,~=</=,></,></code></dt><dd>关系运算符，返回true或false，nil只与自身相等</dd>
<dt><code>and,or,not</code></dt><dd>逻辑运算，有短路特性</dd>
<dt><code>A and B or C</code></dt><dd>类似A?B:C,但B不能为假(false或nil)</dd>
<dt><code>x,y=y,x</code></dt><dd>多重赋值可以交换变量</dd>
<dt><code>..</code></dt><dd>字符串连接操作</dd>
<dt><code>tonumber()</code></dt><dd>强转为数字</dd>
<dt><code>tostring()</code></dt><dd>强转为字符串</dd>
<dt><code>#string</code></dt><dd>获得字符串长度</dd>
<dt><code>table.maxn()</code></dt><dd>返回最大正索引数</dd>

        </dl>
    </article>
</section>
<section>
    <article>
        <h2>杂项</h2>
        <dl>
        <dt><code>代码不需要分隔符，换行和分号都没有作用</code></dt><dd></dd>
<dt><code>标识符以字母或下划线开头，不能以数字开头</code></dt><dd></dd>
<dt><code>--something</code></dt><dd>单行注释</dd>
<dt><code>--[[A,B,C//\n   --]]</code></dt><dd>多行注释</dd>
<dt><code>--[[A,B,C//\n   --]]</code></dt><dd>多行注释</dd>
<dt><code>--[[ ->  ---[[</code></dt><dd>代码测试技巧：在多行注释前一个加上一个-取消注释</dd>
<dt><code>--[[ ->  ---[[</code></dt><dd>代码测试技巧：在多行注释前一个加上一个-取消注释</dd>
<dt><code>#!/usr/local/bin/lua</code></dt><dd>脚本头格式   </dd>

        </dl>
    </article>
</section>
<section>
    <article>
        <h2>解释，编译</h2>
        <dl>
        <dt><code>lua -i a.lua</code></dt><dd>在执行完脚本之后将进入交互模式</dd>
<dt><code>lua -e "print()"</code></dt><dd>单行执行命令</dd>
<dt><code>lua -l a</code></dt><dd>加载库文件</dd>
<dt><code>dofile('filename')</code></dt><dd>交互式中执行脚本</dd>
<dt><code>loadfile('filename')</code></dt><dd>加载脚本，编译成函数后返回这个函数</dd>
<dt><code>loadstring(string)</code></dt><dd>将字符串作为lua代码执行，从内存中获得代码</dd>
<dt><code>loadlib()</code></dt><dd>加载动态链接库</dd>

        </dl>
    </article>
</section>
<section>
    <article>
        <h2>错误与异常</h2>
        <dl>
        <dt><code>assert(f(),"string")</code></dt><dd>错误提示函数,若f()返回nil或false则返回string，若f()返回true则返回f()的值</dd>
<dt><code>error({code="string"})</code></dt><dd>可以进行消息传递</dd>
<dt><code>a,b=pcall(f())</code></dt><dd></dd>
<dt><code>a==false</code></dt><dd></dd>
<dt><code>b.code == 'string'</code></dt><dd></dd>

        </dl>
    </article>
</section>
<section>
    <article>
        <h2>控制结构</h2>
        <dl>
        <dt><code>do something end</code></dt><dd>顺序块</dd>
<dt><code>if a==b then .. elseif a==c then .. else .. end</code></dt><dd>条件</dd>
<dt><code>while a==b do..end</code></dt><dd>循环</dd>
<dt><code>repeat..until a==b</code></dt><dd>直到</dd>
<dt><code>for a=1,2,3, do..end</code></dt><dd>数字型for</dd>
<dt><code>for i,v in ipairs(x) do..end</code></dt><dd>泛型for和迭代器</dd>
<dt><code>do break end</code></dt><dd></dd>
<dt><code>do return end</code></dt><dd>注意break和return只能在else,until,end之前</dd>

        </dl>
    </article>
</section>
<section>
    <article>
        <h2>迭代器</h2>
        <dl>
        <dt><code>io.lines()</code></dt><dd>文件每行</dd>
<dt><code>pairs()</code></dt><dd>table的key和value</dd>
<dt><code>ipairs()</code></dt><dd>数组</dd>
<dt><code>string.gmatch()</code></dt><dd>字符串内每单词</dd>

        </dl>
    </article>
</section>
<section>
    <article>
        <h2>协同程序 coroutine</h2>
        <dl>
        <dt><code>四种状态</code></dt><dd></dd>
<dt><code>suspended  </code></dt><dd>  挂起</dd>
<dt><code>running     </code></dt><dd> 执行</dd>
<dt><code>dead        </code></dt><dd> 死亡</dd>
<dt><code>normal      </code></dt><dd> 正常</dd>
<dt><code>coroutine.create(匿名函数)</code></dt><dd>创建一个协同函数</dd>
<dt><code>coroutine.status(函数名)</code></dt><dd>返回函数状态</dd>
<dt><code>coroutine.resume(实参...)</code></dt><dd>使函数执行</dd>
<dt><code>coroutine.yield(函数名，返回值...)</code></dt><dd>挂起函数</dd>

        </dl>
    </article>
</section>
<section>
    <article>
        <h2>设计模式</h2>
        <dl>
        <dt><code>消费者驱动</code></dt><dd>处理数据的函数唤醒生产者，生产者产生数据后挂起并把数据传递给消费者函数</dd>
<dt><code>非抢先多线程</code></dt><dd>为每个任务创建一个线程，当一个线程没有数据可处理时把控制权交给调度函数，由调度函数唤起另一个线程</dd>

        </dl>
    </article>
</section>
<section>
    <article>
        <h2>模块与包</h2>
        <dl>
        <dt><code>require "name" </code></dt><dd>使用模块</dd>
<dt><code>module ( name,package.seeall)..return name</code></dt><dd>创建一个table并返回,编写模块</dd>

        </dl>
    </article>
</section>
<section>
    <article>
        <h2>简单IO操作</h2>
        <dl>
        <dt><code>io.input('filename')</code></dt><dd>读文件</dd>
<dt><code>io.output('filename')</code></dt><dd>写文件</dd>
<dt><code>io.read(参数)</code></dt><dd>参数见下，读取</dd>
<dt><code>"*all"</code></dt><dd>全部文件内容</dd>
<dt><code>"*line"</code></dt><dd>按行读</dd>
<dt><code>io.write(string...)</code></dt><dd>写文件</dd>

            </dl>
        </article>
    </section>
</body>

</article>
</section>
        
      </div>
      
        <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Chimez<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
       
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/categories/文章/" class="mobile-nav-link">Blog</a>
  
    <a href="/categories/备忘卡/" class="mobile-nav-link">Cheatsheet</a>
  
    <a href="/categories/思维导图/" class="mobile-nav-link">Mindmap</a>
  
    <a href="/categories/项目/" class="mobile-nav-link">Project</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script src="http://lib.sinaapp.com/js/jquery/3.1.0/jquery-3.1.0.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  </div>
</body>
</html>

