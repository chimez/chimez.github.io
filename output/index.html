<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Blog of chimez">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>chimez's blog</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="rss.xml">
<link rel="canonical" href="https://chimez.github.io/">
<link rel="next" href="index-3.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/rust-optimization/" type="text/html">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href=".">

            <span id="blog-title">chimez's blog</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav"></ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
    
        

    
        
    <div class="postindex">
            <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/rust-optimization/" class="u-url">Rust Optimization</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        chimez
                    </span></p>
            <p class="dateline">
            <a href="posts/rust-optimization/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-20T14:33:34+08:00" itemprop="datePublished" title="2021-05-20 14:33">2021-05-20 14:33</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div id="outline-container-org5a85a01" class="outline-2">
<h2 id="org5a85a01">Rust 性能优化</h2>
<div class="outline-text-2" id="text-org5a85a01">
<p>
这里所称性能优化实际上就是 Rust 的正确打开方式，因为 Rust 的安全特性导致按照 c/c++ 方式直接写程序有可能速度会比较慢。
</p>
</div>

<div id="outline-container-org19dbdf9" class="outline-3">
<h3 id="org19dbdf9">避免边界检查</h3>
<div class="outline-text-3" id="text-org19dbdf9">
</div>
<div id="outline-container-org5d3f916" class="outline-4">
<h4 id="org5d3f916">参考资料</h4>
<div class="outline-text-4" id="text-org5d3f916">
<ol class="org-ol">
<li>
<a href="https://users.rust-lang.org/t/how-to-malloc-an-array-in-heap-like-c/27827/40">这里</a> 的说明</li>
</ol>
</div>
</div>

<div id="outline-container-orge0776a0" class="outline-4">
<h4 id="orge0776a0">使用 slice 为编译器提示长度</h4>
<div class="outline-text-4" id="text-orge0776a0">
<p>
vec 等类型的参数传递给函数后，在函数内部重新用 slice 的方式定义变量
</p>

<div class="highlight"><pre><span></span>    fn f_for(a: &amp;Vec&lt;f64&gt;, b: &amp;mut Vec&lt;f64&gt;){
	// 不可变量直接用长度做 slice
	let a = &amp;a[..a.len()];
	// 可变量先定义一个长度再做 slice
	let len_b = b.len();
	let b = &amp;mut b[..len_b];
    }
</pre></div>
</div>
</div>

<div id="outline-container-org14a899f" class="outline-4">
<h4 id="org14a899f">尽可能使用迭代器而不是指标循环</h4>
<div class="outline-text-4" id="text-org14a899f">
<p>
迭代器中的边界检查被优化掉了
</p>

<div class="highlight"><pre><span></span>    for (i, ai) in a.iter().enumerate(){
	do_something();
    }

    // 而不是

    for i in 0..n{
	a[i];
    }
</pre></div>
</div>
</div>

<div id="outline-container-org02a47b0" class="outline-4">
<h4 id="org02a47b0">不得不用指标获得值时用 unsafe 的非检查方式</h4>
<div class="outline-text-4" id="text-org02a47b0">
<p>
当确保指标不会越界时就可以大胆使用 unsafe
</p>

<div class="highlight"><pre><span></span>    for i in 0..n{
	unsafe {
	    a.get_unchecked(i);
	}
    }

    // not 
    a[i];
</pre></div>
</div>
</div>
</div>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/meson/" class="u-url">meson</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        chimez
                    </span></p>
            <p class="dateline">
            <a href="posts/meson/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-10T16:20:05+08:00" itemprop="datePublished" title="2021-05-10 16:20">2021-05-10 16:20</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div id="outline-container-orge433de1" class="outline-2">
<h2 id="orge433de1">meson 构建工具</h2>
<div class="outline-text-2" id="text-orge433de1">
<p>
网站 <a href="https://mesonbuild.com">meson-build</a>
</p>
</div>

<div id="outline-container-org4ff9799" class="outline-3">
<h3 id="org4ff9799">添加依赖</h3>
<div class="outline-text-3" id="text-org4ff9799">
<div class="highlight"><pre><span></span>   <span class="n">cc</span> <span class="o">=</span> <span class="n">meson</span><span class="o">.</span><span class="n">get_compiler</span><span class="p">(</span><span class="s1">'c'</span><span class="p">)</span>

   <span class="n">all_deps</span> <span class="o">=</span> <span class="p">[]</span>
   <span class="n">thread_dep</span> <span class="o">=</span> <span class="n">dependency</span><span class="p">(</span><span class="s1">'threads'</span><span class="p">)</span>
   <span class="n">all_deps</span> <span class="o">+=</span> <span class="n">thread_dep</span>

   <span class="n">src_dir</span> <span class="o">=</span> <span class="n">include_directories</span><span class="p">(</span><span class="s1">'../src'</span><span class="p">)</span>

   <span class="n">exe</span> <span class="o">=</span> <span class="n">executable</span><span class="p">(</span><span class="s1">'name'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'src1.c'</span><span class="p">,</span> <span class="s1">'src2.c'</span><span class="p">],</span>
	   <span class="n">dependencies</span><span class="p">:</span> <span class="n">all_deps</span><span class="p">,</span> 
	   <span class="n">include_directories</span><span class="p">:</span> <span class="n">src_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgb2447fa" class="outline-3">
<h3 id="orgb2447fa">使用 address sanitizer</h3>
<div class="outline-text-3" id="text-orgb2447fa">
<div class="highlight"><pre><span></span>   CC=clang meson build  -Db_sanitize=address -Db_lundef=false
</pre></div>
</div>
</div>

<div id="outline-container-org0583689" class="outline-3">
<h3 id="org0583689">使用 clang 静态分析</h3>
<div class="outline-text-3" id="text-org0583689">
<div class="highlight"><pre><span></span>meson build
ninja -C build scan-build
</pre></div>
</div>
</div>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/lapack/" class="u-url">LAPACK</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        chimez
                    </span></p>
            <p class="dateline">
            <a href="posts/lapack/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-10T09:46:43+08:00" itemprop="datePublished" title="2021-05-10 09:46">2021-05-10 09:46</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div id="outline-container-org343cbe4" class="outline-2">
<h2 id="org343cbe4">LAPACK</h2>
<div class="outline-text-2" id="text-org343cbe4">
<p>
主页在 <a href="https://www.netlib.org/lapack/">https://www.netlib.org/lapack/</a>, 文档在 <a href="https://www.netlib.org/lapack/explore-html/">https://www.netlib.org/lapack/explore-html/</a>.
</p>

<p>
安装说明
</p>
<ol class="org-ol">
<li>
<code>liblapack</code> 是本体</li>
<li>
<code>liblapacke</code> 是 c 的绑定</li>
</ol>
</div>

<div id="outline-container-org6599002" class="outline-3">
<h3 id="org6599002">dsyevd: 实对称矩阵本征值</h3>
<div class="outline-text-3" id="text-org6599002">
</div>
<div id="outline-container-orga74d5b5" class="outline-4">
<h4 id="orga74d5b5">参数说明</h4>
<div class="outline-text-4" id="text-orga74d5b5">
<ol class="org-ol">
<li>
<code>jobz</code> 计算任务类型， <code>jobz = "N"</code> 只计算本征值， <code>jobz = "V"</code> 计算本征值和本征矢</li>
<li>
<code>UPLO</code> 矩阵的存储方式, <code>UPLO = "U"</code> <code>A</code> 中存了上三角矩阵， <code>UPLO = "L"</code> 下三角矩阵</li>
<li>
<code>N</code> 矩阵维数</li>
<li>
<code>A</code> 输入矩阵 <code>LDA * N</code> 维，计算后会被破坏，或者保存为本征矢</li>
<li>
<code>LDA</code> 矩阵维数</li>
<li>
<code>W</code> 本征值向量 <code>N</code> 维，升序排列</li>
<li>
<code>WORK</code> 工作向量，~LWORK~ 维, <code>WORK[0]</code> 是最优的 <code>LWORK</code> 值</li>
<li>
<code>LWORK</code> 工作向量维数， <code>LWORK = -1</code> 计算最优的 <code>LWORK</code> 值</li>
<li>
<code>IWORK</code> 工作向量， <code>LIWORK</code> 维， <code>IWORK[0]</code> 是最优的 <code>LIWORK</code> 值</li>
<li>
<code>LIWORK</code> 工作向量维数， <code>LIWORK = -1</code> 计算最优的 <code>LIWORK</code> 值</li>
<li>
<code>INFO</code> 错误信息， <code>info = 0</code> 成功</li>
</ol>
</div>
</div>
</div>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/arpack/" class="u-url">arpack</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        chimez
                    </span></p>
            <p class="dateline">
            <a href="posts/arpack/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-07T18:48:36+08:00" itemprop="datePublished" title="2021-05-07 18:48">2021-05-07 18:48</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div id="outline-container-org13f1aa7" class="outline-2">
<h2 id="org13f1aa7">ARPACK</h2>
<div class="outline-text-2" id="text-org13f1aa7">
<p>
新版本在 <a href="https://github.com/opencollab/arpack-ng">arpack-ng</a> , 文档在 <a href="https://www.caam.rice.edu/software/ARPACK/UG/node135.html">rice - ARPACK</a>
</p>
</div>

<div id="outline-container-org046eb4a" class="outline-3">
<h3 id="org046eb4a">函数说明</h3>
<div class="outline-text-3" id="text-org046eb4a">
<p>
头文件 <code>arpack.h</code> 中的函数有
</p>
<ol class="org-ol">
<li>
<code>&lt;?&gt;neupd_c</code> 计算一般矩阵的本征值, <code>&lt;?&gt; = sdcz</code>
</li>
<li>
<code>&lt;?&gt;naupd_c</code> 计算一般矩阵的反向通信接口, <code>&lt;?&gt; = sdcz</code>
</li>
<li>
<code>&lt;?&gt;seupd_c</code> 计算厄米矩阵的本征值, <code>&lt;?&gt; = sd</code>
</li>
<li>
<code>&lt;?&gt;saupd_c</code> 计算厄米矩阵的反向通信接口, <code>&lt;?&gt; = sd</code>
</li>
</ol>
</div>
</div>

<div id="outline-container-org52af175" class="outline-3">
<h3 id="org52af175">
<code>XYaupd</code> 参数说明</h3>
<div class="outline-text-3" id="text-org52af175">
<ol class="org-ol">
<li>
<code>ido</code>   反向通信标志，第一次运行 <code>ido=0</code>
</li>
<li>
<code>bmat</code>  问题类型标志，标准本征值问题 <code>bmat="I"</code> , 扩展本征值问题 <code>bmat="G"</code>
</li>
<li>
<code>n</code>  矩阵维数</li>
<li>
<code>which</code> Ritz值的位置 <code>which="LA", "SA", "LM", "SM", "BE"</code>
</li>
<li>
<code>nev</code> 计算本征值的个数 <code>0 &lt; nev &lt; n</code>
</li>
<li>
<code>tol</code> 浮点精度</li>
<li>
<code>resid</code> 残差向量</li>
<li>
<code>ncv</code> Lanczos 向量个数</li>
<li>
<code>v</code> Lanczos 向量， <code>ncv</code> 列</li>
<li>
<code>ldv</code> Lanczos 向量的首列长度</li>
<li>
<code>iparam</code> <code>int[11]</code> 的数组，保存了 11 个设置参数
<ol class="org-ol">
<li>
<code>iparam[0]=ishift</code> 选择隐式移动的方法， <code>ishift=0</code> 由用户指定， <code>ishift=1</code> 由约化三对角矩阵决定</li>
<li>
<code>iparam[1]=levec</code> 没用</li>
<li>
<code>iparam[2]=mxiter</code> 最大 Arnoldi 更新迭代次数</li>
<li>
<code>iparam[3]=nb</code> 块大小，只能取 <code>nb=1</code>
</li>
<li>
<code>iparam[4]=nconv</code> 收敛了的 Ritz 值个数</li>
<li>
<code>iparam[5]=iupd</code> 没用</li>
<li>
<code>iparam[6]=mode</code> 指定本征值问题的类型只能取 <code>mode = 1,2,3,4,5</code>
</li>
<li>
<code>iparam[7]=np</code> <code>ido=3</code> 时有用</li>
<li>
<code>iparam[8]=numop</code> OP*x 计算的次数</li>
<li>
<code>iparam[9]=numob</code> B*x 计算的次数</li>
<li>
<code>iparam[10]=numreo</code> 重正交化的次数</li>
</ol>
</li>
<li>
<code>ipntr</code> <code>int[11]</code> 的数组，保存指向 <code>workl</code>, <code>workd</code> 中起始位置的指针</li>
<li>
<code>workd</code> <code>3*N</code> 长的数组，算法内部使用</li>
<li>
<code>workl</code> <code>lworkl</code> 长的数组，算法内部使用</li>
<li>
<code>lworkl</code> <code>workl</code> 的长度，至少 <code>ncv**2 + 8*ncv</code>
</li>
<li>
<code>info</code> 运行提示和错误信息</li>
</ol>
</div>
</div>

<div id="outline-container-orgdd4ac2a" class="outline-3">
<h3 id="orgdd4ac2a">
<code>XYeupd</code> 参数说明</h3>
<div class="outline-text-3" id="text-orgdd4ac2a">
<ol class="org-ol">
<li>
<code>rvec</code> 指定是否产生本征矢 <code>rvec=true</code> 产生本征矢， <code>rvec=false</code> 只产生本征值</li>
<li>
<code>howmny</code> 指定产生本征矢的个数 <code>howmny="A"</code> 计算 <code>nev</code> 个， <code>howmny="P"</code> 计算 nev Schur 本征矢， <code>howmny="S"</code> 计算一部分本征值，由 <code>select</code> 指定</li>
<li>
<code>select</code> 指定计算的本征矢</li>
<li>
<code>dr</code> Ritz 值的实部</li>
<li>
<code>di</code> Ritz 值的虚部</li>
<li>
<code>z</code> Ritz 向量</li>
<li>
<code>ldz</code> Ritz 向量的首列维数</li>
<li>
<code>sigmar</code> shift 的实部, iparam[6]=3 or 4 时有效</li>
<li>
<code>sigmai</code> shift 的虚部</li>
<li>
<code>workev</code> 3*ncv 的内部数组</li>
<li>
<code>bmat</code>  以下参数与 <code>XYaupd</code> 相同</li>
<li><code>n</code></li>
<li><code>which</code></li>
<li><code>nev</code></li>
<li><code>tol</code></li>
<li><code>resid</code></li>
<li><code>ncv</code></li>
<li><code>v</code></li>
<li><code>ldv</code></li>
<li><code>iparam</code></li>
<li><code>ipntr</code></li>
<li><code>workd</code></li>
<li><code>workl</code></li>
<li><code>lworkl</code></li>
<li><code>info</code></li>
</ol>
</div>
</div>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/blas/" class="u-url">BLAS</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        chimez
                    </span></p>
            <p class="dateline">
            <a href="posts/blas/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-07T11:47:35+08:00" itemprop="datePublished" title="2021-05-07 11:47">2021-05-07 11:47</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div id="outline-container-orge468d11" class="outline-2">
<h2 id="orge468d11">BLAS</h2>
<div class="outline-text-2" id="text-orge468d11">
<ul class="org-ul">
<li>MKL 中的 BLAS，参考 <a href="https://software.intel.com/content/www/us/en/develop/documentation/onemkl-developer-reference-c/top/blas-and-sparse-blas-routines/blas-routines/naming-conventions-for-blas-routines.html">MKL - BLAS</a>
</li>
<li>标准的 BLAS 参考 <a href="https://www.netlib.org/blas/">netlib - BLAS</a>
</li>
</ul>
</div>

<div id="outline-container-orgfef8337" class="outline-3">
<h3 id="orgfef8337">BLAS 的命名规则</h3>
<div class="outline-text-3" id="text-orgfef8337">
<p>
BLAS 中的函数名一般规则是 <code>&lt;character&gt;&lt;name&gt;&lt;mode&gt; ()</code>
</p>
<ul class="org-ul">
<li>
<code>&lt;character&gt;</code> 指明数据类型
<ul class="org-ul">
<li>
<code>s</code> real, single precision</li>
<li>
<code>c</code> complex, single precision</li>
<li>
<code>d</code> real, double precision</li>
<li>
<code>z</code> complex, double precision</li>
</ul>
</li>
<li>
<code>&lt;name&gt;</code> 指明矩阵类型 BLAS 2 and 3
<ul class="org-ul">
<li>
<code>ge</code> general matrix</li>
<li>
<code>gb</code> general band matrix</li>
<li>
<code>sy</code> symmetric matrix</li>
<li>
<code>sp</code> symmetric matrix (packed storage)</li>
<li>
<code>sb</code> symmetric band matrix</li>
<li>
<code>he</code> hermitian matrix</li>
<li>
<code>hp</code> hermitian matrix (packed storage)</li>
<li>
<code>hb</code> hermitian band matrix</li>
<li>
<code>tr</code> triangular matrix</li>
<li>
<code>tp</code> triangular matrix (packed storage)</li>
<li>
<code>tb</code> triangular band matrix</li>
</ul>
</li>
<li>
<code>&lt;mod&gt;</code> 指明操作的细节
<ul class="org-ul">
<li>
<code>c</code> conjugated vector</li>
<li>
<code>u</code> unconjugated vector</li>
<li>
<code>g</code> Givens rotation construction</li>
<li>
<code>m</code> modified Givens rotation</li>
<li>
<code>mg</code> modified Givens rotation construction</li>
<li>
<code>mv</code> matrix-vector product</li>
<li>
<code>sv</code> solving a system of linear equations with a single unknown vector</li>
<li>
<code>r</code> rank-1 update of matrix</li>
<li>
<code>r2</code> rank-2 update of matrix</li>
<li>
<code>mm</code> matrix-matrix product</li>
<li>
<code>sm</code> solving a system of linear equations with multiple unkonwn vectors</li>
<li>
<code>rk</code> rank-k update of matrix</li>
<li>
<code>r2k</code> rank-2k update of a matrix</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org6b7b696" class="outline-3">
<h3 id="org6b7b696">CBLAS 约定</h3>
<div class="outline-text-3" id="text-org6b7b696">
<p>
CBLAS 是 BLAS 的 c 接口， BLAS 是 fortran 标准。
</p>

<p>
CBLAS 函数都遵循以下约定
</p>

<ul class="org-ul">
<li>输入参数是 <code>const</code> 指针</li>
<li>非复数标量输入参数传值</li>
<li>复标量参数传 <code>void</code> 指针</li>
<li>数组参数传地址</li>
<li>BLAS 特征参数由适当的枚举类型代替</li>
<li>level 2 和 level 3 需要一个额外的 <code>CBLAS_LAYOUT</code> 类型的参数来指定矩阵是行优先 <code>CblasRowMajor</code> 还是列优先 <code>CblasColMajor</code>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgca95bd0" class="outline-3">
<h3 id="orgca95bd0">枚举类型</h3>
<div class="outline-text-3" id="text-orgca95bd0">
<div class="highlight"><pre><span></span>   <span class="k">enum</span> <span class="n">CBLAS_LAYOUT</span> <span class="p">{</span>
      <span class="n">CblasRowMajor</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>    <span class="cm">/* row-major arrays */</span>
      <span class="n">CblasColMajor</span><span class="o">=</span><span class="mi">102</span><span class="p">};</span>   <span class="cm">/* column-major arrays */</span>

   <span class="k">enum</span> <span class="n">CBLAS_TRANSPOSE</span> <span class="p">{</span>
      <span class="n">CblasNoTrans</span><span class="o">=</span><span class="mi">111</span><span class="p">,</span>     <span class="cm">/* trans='N' */</span>
      <span class="n">CblasTrans</span><span class="o">=</span><span class="mi">112</span><span class="p">,</span>       <span class="cm">/* trans='T' */</span>
      <span class="n">CblasConjTrans</span><span class="o">=</span><span class="mi">113</span><span class="p">};</span>  <span class="cm">/* trans='C' */</span>

   <span class="k">enum</span> <span class="n">CBLAS_UPLO</span> <span class="p">{</span>
      <span class="n">CblasUpper</span><span class="o">=</span><span class="mi">121</span><span class="p">,</span>        <span class="cm">/* uplo ='U' */</span>
      <span class="n">CblasLower</span><span class="o">=</span><span class="mi">122</span><span class="p">};</span>       <span class="cm">/* uplo ='L' */</span>

   <span class="k">enum</span> <span class="n">CBLAS_DIAG</span> <span class="p">{</span>
      <span class="n">CblasNonUnit</span><span class="o">=</span><span class="mi">131</span><span class="p">,</span>      <span class="cm">/* diag ='N' */</span>
      <span class="n">CblasUnit</span><span class="o">=</span><span class="mi">132</span><span class="p">};</span>        <span class="cm">/* diag ='U' */</span>

   <span class="k">enum</span> <span class="n">CBLAS_SIDE</span> <span class="p">{</span>
      <span class="n">CblasLeft</span><span class="o">=</span><span class="mi">141</span><span class="p">,</span>         <span class="cm">/* side ='L' */</span>
      <span class="n">CblasRight</span><span class="o">=</span><span class="mi">142</span><span class="p">};</span>       <span class="cm">/* side ='R' */</span>
</pre></div>
</div>
</div>

<div id="outline-container-org9304e2e" class="outline-3">
<h3 id="org9304e2e">矩阵存储方式</h3>
<div class="outline-text-3" id="text-org9304e2e">
<ol class="org-ol">
<li>完全存储矩阵 \(A_{ij}_{}\) 在二维数组列存储 <code>a[i + j*lda]</code> 行存储 <code>a[i*lda + j]</code>
</li>
<li>packed storage 可以用更有效的方式存储矩阵</li>
</ol>
</div>
</div>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/extending-python-with-c/" class="u-url">Extending Python with C</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        chimez
                    </span></p>
            <p class="dateline">
            <a href="posts/extending-python-with-c/" rel="bookmark">
            <time class="published dt-published" datetime="2021-05-03T19:16:46+08:00" itemprop="datePublished" title="2021-05-03 19:16">2021-05-03 19:16</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div id="outline-container-orgaf204c4" class="outline-2">
<h2 id="orgaf204c4">用 C 扩展 Python</h2>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/bose-hubbard-model-mean-field-theory/" class="u-url">Bose-Hubbard model mean field theory</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        chimez
                    </span></p>
            <p class="dateline">
            <a href="posts/bose-hubbard-model-mean-field-theory/" rel="bookmark">
            <time class="published dt-published" datetime="2021-04-25T01:20:52+08:00" itemprop="datePublished" title="2021-04-25 01:20">2021-04-25 01:20</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bose-Hubbard-模型的平均场解">Bose-Hubbard 模型的平均场解<a class="anchor-link" href="posts/bose-hubbard-model-mean-field-theory/#Bose-Hubbard-%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%B9%B3%E5%9D%87%E5%9C%BA%E8%A7%A3">¶</a>
</h2>
<h4 id="Bose-Hubbard-模型-{#bose-hubbard-模型}">Bose-Hubbard 模型 {#bose-hubbard-模型}<a class="anchor-link" href="posts/bose-hubbard-model-mean-field-theory/#Bose-Hubbard-%E6%A8%A1%E5%9E%8B-%7B#bose-hubbard-%E6%A8%A1%E5%9E%8B%7D">¶</a>
</h4>
<p><a href="https://en.wikipedia.org/wiki/Bose%E2%80%93Hubbard%5Fmodel">Bose-Hubbard 模型</a> 是一维的无自旋玻色子格点模型。</p>
<p>哈密顿量为</p>
$$
H = -t \sum\_{\langle i,j \rangle} b^{\dagger}\_{i}b\_{j} + \frac{U}{2} \sum\_{i} n\_{i} (n\_{i} -1) - \mu \sum\_{i} n\_{i}
$$<p>其中 $-t$ 是最近邻跃迁强度， $U$ 是相互作用强度， $\mu$ 是化学势。</p>
<h4 id="平均场哈密顿量">平均场哈密顿量<a class="anchor-link" href="posts/bose-hubbard-model-mean-field-theory/#%E5%B9%B3%E5%9D%87%E5%9C%BA%E5%93%88%E5%AF%86%E9%A1%BF%E9%87%8F">¶</a>
</h4>
<p>平均场近似为
$$
a^{\dagger}\_{i} a\_{j} = \langle a^{\dagger}\_{i} \rangle a\_{j} + a^{\dagger}\_{i} \langle a\_{j} \rangle - \langle a^{\dagger}\_{i} \rangle \langle a\_{j} \rangle
$$</p>
<p>代入就得到单点平均场哈密顿量
$$
H\_{i}^{\mathrm{MF}} = \frac{U}{2} n\_{i} (n\_{i} -1) - \mu n\_{i} - \psi (a\_{i} + a\_{i}^{\dagger}) + |\psi|
$$</p>
<p>其中 $\psi = \langle a^{\dagger}\_{i} \rangle = \langle a\_{i} \rangle $ 是超流序参量。</p>
<h4 id="求解">求解<a class="anchor-link" href="posts/bose-hubbard-model-mean-field-theory/#%E6%B1%82%E8%A7%A3">¶</a>
</h4>
<p>由于是玻色模型，所以需要先确定合适的截断尺寸。步骤就是先计算小的截断尺寸的基态能量，再逐渐加大截断数直到收敛。</p>
<p>确定截断之后就把 $\psi$ 做自变量，寻找能使基态能量最小的 $\psi$ ，迭代自洽收敛的效果很好，直接做优化则很难找到全局最优。</p>
<p>得到不同参数的 $\psi$ 再计算 $\langle n \rangle$ 两个对比，就能看到超流相和 Mott 绝缘体相之间的变化，以及化学势导致的不同 Mott 平台。</p>
<h4 id="参考文献">参考文献<a class="anchor-link" href="posts/bose-hubbard-model-mean-field-theory/#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE">¶</a>
</h4>
<ol>
<li>首先给出 Bose-Hubbard 模型的平均场解的是 (<a href="posts/bose-hubbard-model-mean-field-theory/#org02ecd18">Sheshadri et al. 1993</a>) .
Sheshadri, K., H. R. Krishnamurthy, R. Pandit, and T. V. Ramakrishnan. 1993. “Superfluid and Insulating Phases in an Interacting-Boson Model: Mean-Field Theory and the RPA.” Europhysics Letters (EPL) 22 (4). IOP Publishing:257–63.</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">sop</span>
<span class="kn">import</span> <span class="nn">scipy.sparse</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">scipy.sparse.linalg</span> <span class="k">as</span> <span class="nn">slin</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">dag</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">annihilation</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="o">=</span><span class="s2">"dense"</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">tp</span> <span class="o">==</span> <span class="s2">"dense"</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">M</span><span class="p">)),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">tp</span> <span class="o">==</span> <span class="s2">"sparse"</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dia_matrix</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">a</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_Hi</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">annihilation</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
    <span class="n">ad</span> <span class="o">=</span> <span class="n">dag</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">ad</span> <span class="o">@</span> <span class="n">a</span>
    <span class="k">if</span> <span class="n">tp</span> <span class="o">==</span> <span class="s2">"dense"</span><span class="p">:</span>
        <span class="n">mI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">tp</span> <span class="o">==</span> <span class="s2">"sparse"</span><span class="p">:</span>
        <span class="n">mI</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">Hi</span> <span class="o">=</span> <span class="n">U</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">@</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">mI</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="n">psi</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">ad</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">mI</span>
    <span class="k">return</span> <span class="n">Hi</span>


<span class="k">def</span> <span class="nf">eig_Hi</span><span class="p">(</span><span class="n">Hi</span><span class="p">,</span> <span class="n">tp</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">tp</span> <span class="o">==</span> <span class="s2">"dense"</span><span class="p">:</span>
        <span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">Hi</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">eigvals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">eigvecs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">tp</span> <span class="o">==</span> <span class="s2">"sparse"</span><span class="p">:</span>
        <span class="n">el</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">slin</span><span class="o">.</span><span class="n">eigsh</span><span class="p">(</span><span class="n">Hi</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">"SA"</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">el</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">e</span><span class="p">,</span> <span class="n">v</span>


<span class="k">def</span> <span class="nf">calc_psi</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">tp</span><span class="p">):</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">annihilation</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">dag</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">@</span> <span class="n">a</span> <span class="o">@</span> <span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">find_M</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">tp</span><span class="p">):</span>
    <span class="n">e_old</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
        <span class="n">Hi</span> <span class="o">=</span> <span class="n">make_Hi</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
        <span class="n">e</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">eig_Hi</span><span class="p">(</span><span class="n">Hi</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
        <span class="c1"># psi=calc_psi(v,tp)</span>
        <span class="c1"># print(M,e)</span>
        <span class="k">if</span> <span class="n">e_old</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">e_old</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">e_old</span> <span class="o">=</span> <span class="n">e</span>
    <span class="k">return</span> <span class="n">M</span>


<span class="k">def</span> <span class="nf">find_psi</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">):</span>
    <span class="n">psi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span>
    <span class="n">e_old</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>

        <span class="n">Hi</span> <span class="o">=</span> <span class="n">make_Hi</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
        <span class="n">e</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">eig_Hi</span><span class="p">(</span><span class="n">Hi</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="n">calc_psi</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
        <span class="c1"># print(e,e_old)</span>
        <span class="k">if</span> <span class="n">e_old</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">e_old</span> <span class="o">=</span> <span class="n">e</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">e_old</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">e_old</span> <span class="o">=</span> <span class="n">e</span>

    <span class="k">return</span> <span class="n">e</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">v</span>


<span class="k">def</span> <span class="nf">find_psi_variational</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_f</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">):</span>
        <span class="n">Hi</span> <span class="o">=</span> <span class="n">make_Hi</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
        <span class="n">e</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">eig_Hi</span><span class="p">(</span><span class="n">Hi</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">e</span>

    <span class="n">sol</span> <span class="o">=</span> <span class="n">sop</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(),</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">))</span>

    <span class="n">Hi</span> <span class="o">=</span> <span class="n">make_Hi</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
    <span class="n">e</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">eig_Hi</span><span class="p">(</span><span class="n">Hi</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">e</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span>


<span class="k">def</span> <span class="nf">calc_n</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">tp</span><span class="p">):</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">annihilation</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
    <span class="n">ad</span> <span class="o">=</span> <span class="n">dag</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">ad</span> <span class="o">@</span> <span class="n">a</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">dag</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">@</span> <span class="n">n</span> <span class="o">@</span> <span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tp</span> <span class="o">=</span> <span class="s2">"dense"</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">Ul</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">mul</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>

<span class="n">UU</span><span class="p">,</span> <span class="n">mumu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">Ul</span><span class="p">,</span> <span class="n">mul</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s2">"ij"</span><span class="p">)</span>
<span class="n">ee</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">UU</span><span class="p">)</span>
<span class="n">psipsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">UU</span><span class="p">)</span>
<span class="n">nn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">UU</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Ul</span><span class="p">))):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mul</span><span class="p">)):</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">UU</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">mumu</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">find_M</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
        <span class="n">e</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">find_psi</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
        <span class="n">ee</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
        <span class="n">psipsi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi</span>
        <span class="n">nn</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">calc_n</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>





 
 
<div id="f98e4c35-f455-47c4-b449-fed8dadbed49"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#f98e4c35-f455-47c4-b449-fed8dadbed49');
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "38aeaef0c82d42d888412e8c1d3f438c", "version_major": 2, "version_minor": 0}
</script>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>这就是巨正则系统的相图，右边圈起来的地方就是 Mott 绝缘体相</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pp</span> <span class="o">=</span> <span class="n">psipsi</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">pp</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pp</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">1e-2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">UU</span><span class="p">,</span> <span class="n">mumu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pp</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.contour.QuadContourSet at 0x7f6448fae670&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mul</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">el</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
<span class="n">psil</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
<span class="n">nl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">mul</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">U</span> <span class="o">=</span> <span class="mi">20</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mul</span><span class="p">)):</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">mul</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">find_M</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
    <span class="n">e</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">find_psi</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
    <span class="c1"># e, psi, v = find_psi_variational(U, mu, t, M, tp)</span>
    <span class="n">el</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
    <span class="n">psil</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi</span>
    <span class="n">nl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">calc_n</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>对某个特定参数，能够看到在 Mott 平台中超流序参量都是 0，在Mott平台之间超流序参量才不是 0.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">psil</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="n">nl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f6448c9efd0&gt;]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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">
</div>

</div>

</div>
</div>

</div>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/performant-python/" class="u-url">Performant Python</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        chimez
                    </span></p>
            <p class="dateline">
            <a href="posts/performant-python/" rel="bookmark">
            <time class="published dt-published" datetime="2021-04-23T22:03:52+08:00" itemprop="datePublished" title="2021-04-23 22:03">2021-04-23 22:03</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div id="outline-container-org1c9e43d" class="outline-2">
<h2 id="org1c9e43d">Python 性能</h2>
<div class="outline-text-2" id="text-org1c9e43d">
</div>
<div id="outline-container-org4b98e49" class="outline-3">
<h3 id="org4b98e49">计算机结构</h3>
<div class="outline-text-3" id="text-org4b98e49">
<p>
简单来说，计算机由计算单元、储存单元和二者之间的通信构成。
</p>
</div>

<div id="outline-container-org92e1333" class="outline-4">
<h4 id="org92e1333">计算单元</h4>
<div class="outline-text-4" id="text-org92e1333">
<p>
计算单元一般是 CPU 和 GPU 等。
</p>

<p>
计算单元重要的两个参数是
</p>
<ol class="org-ol">
<li>每周期指令 (instructions per cycle, IPC): 每个时钟周期执行的指令数</li>
<li>时钟速度：每秒的时钟周期</li>
</ol>
<p>
如果提高时钟速度了，当然运行速度会变快。另一种方法是增加每个指令的计算量，通过向量化的方式，可以在一个指令中同时处理多个数据，即 SIMD(single instruction multiple data).
</p>

<p>
由于物理和技术限制，时钟速度的增加基本停止了，所以增加同一时间内运算量的方法就是增加更多的 CPU， 即并行化。
</p>
</div>
</div>

<div id="outline-container-orgb1b9354" class="outline-4">
<h4 id="orgb1b9354">Amdahl'a law</h4>
<div class="outline-text-4" id="text-orgb1b9354">
<p>
经验定律：并行程序的加速上限取决于不能并行化的最小单元。
</p>
</div>
</div>

<div id="outline-container-org4c84302" class="outline-4">
<h4 id="org4c84302">存储单元</h4>
<div class="outline-text-4" id="text-org4c84302">
<p>
存储单元包括：机械硬盘、固态硬盘、RAM、L1/L2 等。主要的区别就是速度。一般来说速度越快容量越小。
</p>

<p>
存储单元速度通常比计算单元慢，所以主要的优化手段就是异步 I/O 和预先缓存，保证计算设备进行计算的时候数据已经准备好了。
</p>
</div>
</div>

<div id="outline-container-org0cf7774" class="outline-4">
<h4 id="org0cf7774">总线</h4>
<div class="outline-text-4" id="text-org0cf7774">
<p>
计算单元和存储单元通过总线连接。
总线最重要的参数是总线宽度和总线频率。
</p>
</div>
</div>
</div>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/petsc/" class="u-url">PETSc</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        chimez
                    </span></p>
            <p class="dateline">
            <a href="posts/petsc/" rel="bookmark">
            <time class="published dt-published" datetime="2021-04-21T15:39:14+08:00" itemprop="datePublished" title="2021-04-21 15:39">2021-04-21 15:39</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div id="outline-container-org8ed1917" class="outline-2">
<h2 id="org8ed1917">PETSc</h2>
<div class="outline-text-2" id="text-org8ed1917">
<p>
<a href="https://www.mcs.anl.gov/petsc/index.html">PETSc</a> 是用于开发并行计算程序的基础库，完全建立在 MPI 上。
</p>
</div>

<div id="outline-container-org7e7c1b7" class="outline-3">
<h3 id="org7e7c1b7">安装与编译</h3>
<div class="outline-text-3" id="text-org7e7c1b7">
<ul class="org-ul">
<li>在 Debian 上有包 <code>petsc-dev</code>
</li>
<li>下载 <a href="https://www.mcs.anl.gov/petsc/download/">源码</a>
</li>
</ul>
</div>
</div>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/data-structures-for-sparse-matrix/" class="u-url">Data Structures for Sparse Matrix</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        chimez
                    </span></p>
            <p class="dateline">
            <a href="posts/data-structures-for-sparse-matrix/" rel="bookmark">
            <time class="published dt-published" datetime="2021-04-19T15:24:09+08:00" itemprop="datePublished" title="2021-04-19 15:24">2021-04-19 15:24</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div id="outline-container-org5a53365" class="outline-2">
<h2 id="org5a53365">稀疏矩阵的数据结构</h2>
<div class="outline-text-2" id="text-org5a53365">
</div>
<div id="outline-container-orgde2f7e5" class="outline-3">
<h3 id="orgde2f7e5">常见结构</h3>
<div class="outline-text-3" id="text-orgde2f7e5">
<ul class="org-ul">
<li>COO: Coordinate or triplet</li>
<li>CSR: Compressed Sparse Row</li>
<li>CSC: Compressed Sparse Column</li>
<li>DIA: Diagonal</li>
<li>BSR: Block Sparse Row</li>
</ul>
</div>
</div>

<div id="outline-container-org7ac5eb1" class="outline-3">
<h3 id="org7ac5eb1">COO: coordinate</h3>
<div class="outline-text-3" id="text-org7ac5eb1">
<ol class="org-ol">
<li>也叫做 triplet 格式</li>
<li>最简单和基本的格式，通常用做向其它格式转换的入门格式</li>
<li>顺序是任意的</li>
<li>保存三列数据：值、行指标、列指标</li>
</ol>
<pre class="example">
A:
   [[ 1,  0,  0,  2,  0],
    [ 3,  4,  0,  5,  0],
    [ 6,  0,  7,  8,  9],
    [ 0,  0, 10, 11,  0],
    [ 0,  0,  0,  0, 12]]

data:   [1, 3, 6, 4, 7, 10, 2, 5, 8, 11, 9, 12]
row(i): [0, 0, 1, 1, 1,  2, 2, 2, 2,  3, 3,  4]
col(j): [0, 3, 0, 1, 3,  0, 2, 3, 4,  2, 3,  4]

A[ i[k], j[k] ] = data[k]
</pre>
</div>
</div>

<div id="outline-container-orgedf8ef4" class="outline-3">
<h3 id="orgedf8ef4">CSR: Compressed Sparse Row</h3>
<div class="outline-text-3" id="text-orgedf8ef4">
<ol class="org-ol">
<li>按行压缩，即coo格式中的数据值、列指标不变，但行指标改成指向这一行开始的列的指标</li>
<li>一般来说，Fortran 里使用这种格式</li>
</ol>
<pre class="example">
A:
   [[ 1,  0,  0,  2,  0],
    [ 3,  4,  0,  5,  0],
    [ 6,  0,  7,  8,  9],
    [ 0,  0, 10, 11,  0],
    [ 0,  0,  0,  0, 12]]

data:   [1, 3, 6, 4, 7, 10, 2, 5, 8, 11, 9, 12]
row(i): [0, 2, 5, 9, 11, 12]
col(j): [0, 3, 0, 1, 3,  0, 2, 3, 4,  2, 3,  4]

</pre>
</div>
</div>

<div id="outline-container-orgc646017" class="outline-3">
<h3 id="orgc646017">CSC: Compressed Sparse Column</h3>
<div class="outline-text-3" id="text-orgc646017">
<ol class="org-ol">
<li>按列压缩，与 CSR 类似，不过行列换一下</li>
<li>c 中常用这种格式</li>
</ol>
<pre class="example">
A:
   [[ 1,  0,  0,  2,  0],
    [ 3,  4,  0,  5,  0],
    [ 6,  0,  7,  8,  9],
    [ 0,  0, 10, 11,  0],
    [ 0,  0,  0,  0, 12]]

data:   [1, 3, 6, 4, 7, 10, 2, 5, 8, 11, 9, 12]
row(i): [0, 1, 2, 1, 2,  3, 0, 1, 2,  3, 2,  4]
col(j): [0, 3, 4, 6, 10, 12]

</pre>
</div>
</div>

<div id="outline-container-orga4bbede" class="outline-3">
<h3 id="orga4bbede">DIA: The Diagonal format</h3>
<div class="outline-text-3" id="text-orga4bbede">
<ol class="org-ol">
<li>按对角线压缩，保存偏移值，负的偏移忽略头元素，正的偏移忽略尾元素</li>
</ol>
<pre class="example">
A:
   [[ 1.,  0.,  2.,  0.,  0.],
    [ 3.,  4.,  0.,  5.,  0.],
    [ 0.,  6.,  7.,  0.,  8.],
    [ 0.,  0.,  9., 10.,  0.],
    [ 0.,  0.,  0., 11., 12.]]

data:
   [[ 3.,  6.,  9., 11., nan],
    [ 1.,  4.,  7., 10., 12.],
    [nan, nan,  2.,  5.,  8.]]

offsets: [-1,  0,  2]

</pre>
</div>
</div>

<div id="outline-container-org624a323" class="outline-3">
<h3 id="org624a323">BSR: Block matrices</h3>
<div class="outline-text-3" id="text-org624a323">
<ol class="org-ol">
<li>类似 CSR，只不过每个行列指的是一个小的矩阵，这些小矩阵大小都相等</li>
</ol>
</div>
</div>

<div id="outline-container-orgf646a7e" class="outline-3">
<h3 id="orgf646a7e">scipy 格式</h3>
<div class="outline-text-3" id="text-orgf646a7e">
<ol class="org-ol">
<li>很容易使用，参考 <a href="https://docs.scipy.org/doc/scipy/reference/sparse.html">scipy - sparse</a>
</li>
</ol>
</div>
</div>

<div id="outline-container-org4749234" class="outline-3">
<h3 id="org4749234">suitesparse 格式</h3>
</div>

<div id="outline-container-org05849a6" class="outline-3">
<h3 id="org05849a6">MKL 格式</h3>
</div>
</div>
                </div>
            </article>
</div>
    
        <ul class="pager postindexpager clearfix">
<li class="next"><a href="index-3.html" rel="next">Older posts</a></li>
        </ul>
<script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script><script>
                renderMathInElement(document.body,
                    {
                        
delimiters: [
    {left: "$$", right: "$$", display: true},
    {left: "\\[", right: "\\]", display: true},
    {left: "\\begin{equation*}", right: "\\end{equation*}", display: true},
    {left: "$", right: "$", display: false},
    {left: "\\(", right: "\\)", display: false}
]

                    }
                );
            </script><!--End of body content--><footer id="footer">
            Contents © 2021         <a href="mailto:chimez@163.com">chimez</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
            
        </footer>
</div>
</div>


        <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
