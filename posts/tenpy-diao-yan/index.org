#+BEGIN_COMMENT
.. title: TeNPy è°ƒç ”
.. slug: tenpy-diao-yan
.. date: 2023-10-18 11:03:14 UTC+08:00
.. tags: python,
.. category: library
.. link: 
.. description: 
.. type: text
.. has_math: true

#+END_COMMENT

DMRG / MPS / å¼ é‡ç½‘ç»œçš„å¼€æºåº“æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ [[https://github.com/tenpy/tenpy.git][TeNPy]], [[https://itensor.org/][ITensor]], [[https://github.com/jutho/TensorKit.jl][TensorKit]], [[https://bitbucket.org/aweichselbaum/workspace/projects/QS][QSpace]], [[https://github.com/g1257/dmrgpp][DMRG++]], [[https://uni10.gitlab.io/][uni10]], [[https://github.com/cmendl/pytenet][PyTeNet]], [[https://github.com/jcmgray/quimb][quimb]], [[https://github.com/dsuess/mpnum][mpnum]], [[https://green.physics.lsa.umich.edu/alps_legacy/index.php][ALPS project]], [[https://github.com/issp-center-dev/TeNeS][TeNeS]], [[https://syten.eu/][SyTen]], ç­‰ç­‰ã€‚
è¿™ä¸ªç³»åˆ—æ–‡ç« å°†ä¼šä»è¿™äº›åº“ä¸­é€‰æ‹©å‡ ä¸ªæ¥å­¦ä¹ å’Œåˆ†æä¸€ä¸‹ã€‚

#+CAPTION: è®©æˆ‘ä»¬å†é€ ä¸ªè½®å­ğŸ¤£
[[https://imgs.xkcd.com/comics/standards.png]]

[[https://github.com/tenpy/tenpy][TeNPy]]ç”±[[https://johannes-hauschild.de/][Johannes Hauschild]]ä¸»è¦å¼€å‘å¹¶ç»´æŠ¤ï¼ŒHauschild çš„åšå£«å¯¼å¸ˆæ˜¯ Frank Pollmannï¼Œç°åœ¨åœ¨åˆ°å¤„åšåšåã€‚
è€ƒè™‘åˆ° Hauschild ä¸€ä½œçš„æ–‡ç« æ²¡æœ‰å‡ ä¸ªï¼Œå‘è¡¨æƒ…å†µå¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œæ‰€ä»¥æŸç§ç¨‹åº¦ä¸Šä»–æ˜¯åœ¨å…¨èŒåš TeNPy çš„å¼€å‘ã€‚


* å®‰è£…

#+begin_src bash
# å®‰è£…ä¾èµ–
pip install -U pip numpy scipy cython setuptools wheel build
# ä¸‹è½½æºç 
git clone https://github.com/tenpy/tenpy.git
# å®‰è£…
cd tenpy
pip install -e .
# æµ‹è¯•
cd tests
pip install pytest
pytest
#+end_src 

* ä»£ç å±‚çº§

TeNPy çš„ä»£ç å±‚çº§å¦‚å›¾[[fig:tenpy-code-level]]ã€‚

- ~tenpy.simulations~ æ˜¯ç¨‹åºçš„å…¥å£ï¼Œæä¾›è¿è¡Œç¨‹åºï¼ˆè¿›è¡Œè¯»å–å‚æ•°ã€è¿è¡Œè®¡ç®—ã€æ‰§è¡Œæµ‹é‡ã€ä¿å­˜ç»“æœå’Œä¸­é—´è¿‡ç¨‹ç­‰ç­‰ï¼‰çš„åŠŸèƒ½
- ~tenpy.algorithms~ ä¸­å®ç°äº†å¤šç§ç®—æ³•ï¼ŒåŒ…æ‹¬ DMRGã€iDMRGã€TEBDå’ŒTDVP
- ~tenpy.models~ ä¸­å®ç°äº†å„ç§æ¨¡å‹åŒ…æ‹¬è‡ªæ—‹ã€è´¹ç±³ã€æ³¢è‰²å’Œå„ç§æ™¶æ ¼ç»“æ„ã€‚äºŒç»´æ™¶æ ¼é€šè¿‡æ˜ å°„åˆ°ä¸€ç»´æ¥å®ç°ã€‚
- ~tenpy.networks~ ä¸­å®ç°äº† MPS å’Œ MPO ç±»å‹
- ~tenpy.linalg~ ä¸­å®ç°äº†å¸¦æœ‰å®ˆæ’é‡çš„å¼ é‡ä»¥åŠè¿­ä»£å¯¹è§’åŒ–ç®—æ³• Lanczos å’Œ Arnoldi
- ~tenpy.tools~ ä¸­åŒ…æ‹¬ä¸€äº›éœ€è¦ç”¨åˆ°å…¶å®ƒåŠŸèƒ½

#+CAPTION: TeNPy çš„ä»£ç å±‚çº§
#+NAME: fig:tenpy-code-level
[[https://tenpy.readthedocs.io/en/latest/_images/overview.png]]

* ~tenpy.linalg.np_conserved.Array~

TeNPy çš„åŸºæœ¬æ•°æ®ç»“æ„æ˜¯ ~tenpy.linalg.np_conserved.Array~, å¸¦æœ‰å®ˆæ’è·çš„å¼ é‡ã€‚
TeNPy é‡‡ç”¨å¸¦æœ‰ç®­å¤´çš„ MPS è®°å·æ¥è¡¨ç¤ºä¸€ä¸ªå¼ é‡ã€‚
å¼ é‡çš„æ¯ä¸ªæŒ‡æ ‡æœ‰è‹¥å¹²å¯èƒ½çš„é‡å­æ•°ï¼Œè¿™äº›ä¿¡æ¯è®°å½•åœ¨ ~Array.legs~ å±æ€§é‡Œã€‚
å¯¹äºä¸€ä¸ªæœ‰ $n$ ä¸ªæŒ‡æ ‡çš„å¼ é‡,  ~Array.legs~ æ˜¯é•¿åº¦ä¸º $n$ çš„æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ ~tenpy.linalg.charges.LegCharge~ , è¿™é‡Œè®°å½•äº†è¿™ä¸ªæŒ‡æ ‡æ‰€æœ‰å¯èƒ½çš„è·ä»¥åŠå®ƒæ˜¯å…¥æŒ‡æ ‡è¿˜æ˜¯å‡ºæŒ‡æ ‡ã€‚
å¼ é‡çš„å±æ€§ ~Array.qtotal~ è®°å½•æ€»é‡å­æ•°ï¼Œåªæœ‰é‚£äº›å’Œç­‰äºæ€»é‡å­æ•°çš„å—æ‰ä¼šè¢«ä¿å­˜ã€‚
æ¯ä¸ªä¿å­˜çš„å¼ é‡å—çš„æ•°æ®æ˜¯æ•°ç»„ ~Array._data~ çš„ä¸€ä¸ªå…ƒç´ ï¼Œå®ƒå¯¹äºçš„é‡å­æ•°åˆ™æ˜¯çŸ©é˜µ ~Array._qdata~ çš„ä¸€è¡Œã€‚

#+BEGIN_EXAMPLE
class Array{
    legs   : List[LegCharge],
    qtotal : Charge,
    _data  : List[numpy.ndarray],
    _qdata : numpy.ndarray[len(â€‹_data), len(legs)],
}
#+END_EXAMPLE

* ~tenpy.networks.site.Site~

~tenpy.networks.site.Site~ æ˜¯ä¸€ä¸ªæ ¼ç‚¹æˆ–è€…ä¸€ä¸ªç‰©ç†æŒ‡æ ‡æ‰€éœ€è¦çš„æ•°æ®ã€‚
å®ƒä¿å­˜äº†ç‰©ç†æŒ‡æ ‡æ‰€éœ€è¦çš„ä¿¡æ¯ ~LegCharge~, ä»¥åŠä½œç”¨åœ¨ä¸€ä¸ªæ ¼ç‚¹ä¸Šçš„æ‰€æœ‰å±€åŸŸç®—ç¬¦ ~Site.ops~, å†™æ¨¡å‹çš„å“ˆå¯†é¡¿é‡æ‰€éœ€è¦çš„æ‰€æœ‰ç®—ç¬¦éƒ½æ˜¯ä»è¿™é‡Œå¾—åˆ°çš„ã€‚
é™¤äº†ä¸€èˆ¬çš„ç®—ç¬¦ä¹‹å¤–è¿˜æœ‰ Jordan-Wigner å˜æ¢ï¼ˆå¦‚æœéœ€è¦ï¼‰è¦ç”¨åˆ°çš„ä¿¡æ¯ã€‚

TeNPy ä¸­å®ç°çš„ ~Site~ æœ‰å¦‚ä¸‹è¿™äº›
- ~BosonSite~
- ~ClockSite~
- ~FermionSite~
- ~GroupedSite~
- ~SpinHalfFermionSite~
- ~SpinHalfHoleSite~
- ~SpinHalfSite~
- ~SpinSite~
  
* ~tenpy.networks.mps.MPS~

å¯¹äº $n$ æ ¼ç‚¹çš„é“¾ï¼Œ ~tenpy.networks.mps.MPS~ å°±æ˜¯ $n$ ä¸ª ~Site~ å’Œ $n$ ä¸ª ~Array~, è¿™äº› ~Array~ éƒ½æ˜¯ä¸‰é˜¶å¼ é‡.
TeNPy çš„ MPS è¡¨ç¤ºè®°å½•äº†æ¯ä¸ªå—çš„å½¢å¼ï¼ˆå·¦æ­£åˆ™ã€å³æ­£åˆ™ã€å¯¹ç§°å½¢å¼æˆ–è€…å« Vidal çš„ $\Gamma \Lambda$ å½¢å¼ï¼‰ä»¥åŠéœ€è¦çš„å¥‡å¼‚å€¼ã€‚

#+BEGIN_EXAMPLE
class MPS{
    sites: List[Site],
    _B: List[Array],
    _S: List[numpy.ndarray[1d]],
    form: List[form],
}
#+END_EXAMPLE

* ~tenpy.networks.mpo.MPO~
~tenpy.networks.mpo.MPO~ ä¸ MPS è¡¨ç¤ºç±»ä¼¼ï¼Œåªä¸è¿‡æ¯ä¸ªå—ç°åœ¨æ˜¯å››é˜¶å¼ é‡ã€‚

* ~tenpy.models.model.Model~

~tenpy.models.model.Model~ ç”¨æ¥è¡¨ç¤ºæ¨¡å‹çš„å“ˆå¯†é¡¿é‡ï¼Œéœ€è¦æŒ‡å®šå…ƒèƒæ ¼ç‚¹çš„ä¿¡æ¯ ~Site~ ä»¥åŠæ™¶æ ¼ç»“æ„å¦‚ä½•æ˜ å°„åˆ°ä¸€ç»´é“¾ ~tenpy.models.lattice.Lattice~.
TeNPy æä¾›çš„æ„é€ æ¨¡å‹çš„æ–¹æ³•æ˜¯é€šè¿‡ ~add_onsite~, ~add_coupling~ ç­‰è®¾ç½®å“ˆå¯†é¡¿é‡é‡Œçš„å„é¡¹ï¼Œç„¶åæ ¹æ®éœ€è¦è‡ªåŠ¨æ„é€  MPOã€‚

* DMRG ç®—æ³•

TeNPy çš„æŠ½è±¡å±‚æ¬¡æ˜¯
- ç”± ~tenpy.algorithms.algorithm.Algorithm~ æä¾›è¿è¡Œã€é‡å¯ç­‰åŠŸèƒ½
- ç„¶åç”± ~tenpy.algorithms.mps_common.Sweep~ æä¾›æ‰«æçš„æŠ½è±¡
- æ¯ä¸ªæ‰«ææ­¥éª¤åˆ™ä½¿ç”¨ ~tenpy.algorithms.dmrg.DMRGEngine~ å®ƒå¯ä»¥æ˜¯ ~SingleSiteDMRGEngine~ æˆ–è€… ~TwoSiteDMRGEngine~
